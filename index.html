<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงูพูฺฉุดู ุญุณุงุจุฏุงุฑ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'vazir': ['Vazir', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Vazir:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Vazir', sans-serif; }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .slide-in { animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }
        
        /* Theme Styles */
        [data-theme="light"] {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0e7ff 100%);
        }
        [data-theme="dark"] {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            color: #f1f5f9;
        }
        [data-theme="purple"] {
            background: linear-gradient(135deg, #faf5ff 0%, #e9d5ff 100%);
        }
        [data-theme="gold"] {
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
        }
        
        .theme-bg-secondary {
            background: white;
        }
        [data-theme="dark"] .theme-bg-secondary {
            background: #334155;
        }
        [data-theme="purple"] .theme-bg-secondary {
            background: #fdf4ff;
        }
        [data-theme="gold"] .theme-bg-secondary {
            background: #fefce8;
        }
        
        .theme-text-primary {
            color: #1f2937;
        }
        [data-theme="dark"] .theme-text-primary {
            color: #f1f5f9;
        }
        [data-theme="purple"] .theme-text-primary {
            color: #581c87;
        }
        [data-theme="gold"] .theme-text-primary {
            color: #92400e;
        }
        
        .theme-text-secondary {
            color: #6b7280;
        }
        [data-theme="dark"] .theme-text-secondary {
            color: #cbd5e1;
        }
        [data-theme="purple"] .theme-text-secondary {
            color: #a855f7;
        }
        [data-theme="gold"] .theme-text-secondary {
            color: #d97706;
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }
        
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            margin: 15% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            animation: modalSlideIn 0.3s ease-out;
        }
        
        @keyframes modalSlideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <!-- Authentication Screens -->
    <div id="authScreens" class="min-h-screen flex items-center justify-center">
        <!-- Login Screen -->
        <div id="loginScreen" class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md mx-4">
            <div class="text-center mb-8">
                <div class="text-6xl mb-4">๐ฐ</div>
                <h1 class="text-3xl font-bold text-gray-800 mb-2">ุงูพูฺฉุดู ุญุณุงุจุฏุงุฑ</h1>
                <p class="text-gray-600">ูุฑูุฏ ุจู ุญุณุงุจ ฺฉุงุฑุจุฑ</p>
            </div>
            
            <form id="loginForm" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ฺฉุฏ 12 ุฑูู</label>
                    <input type="text" id="loginCode" required maxlength="12" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" placeholder="ฺฉุฏ 12 ุฑูู ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุฑูุฒ ุนุจูุฑ</label>
                    <input type="password" id="loginPassword" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" placeholder="ุฑูุฒ ุนุจูุฑ ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ">
                </div>
                
                <button type="submit" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-lg font-medium transition-all duration-200 shadow-md hover:shadow-lg">
                    ๐ ูุฑูุฏ
                </button>
            </form>
            
            <div class="mt-6 text-center">
                <p class="text-gray-600">ุญุณุงุจ ฺฉุงุฑุจุฑ ูุฏุงุฑุฏุ</p>
                <button onclick="showRegisterScreen()" class="text-blue-500 hover:text-blue-600 font-medium">ุซุจุช ูุงู ฺฉูุฏ</button>
            </div>
            
            <div class="mt-4 text-center">
                <button onclick="showCodeActivationScreen()" class="text-green-500 hover:text-green-600 font-medium text-sm">ูุนุงูโุณุงุฒ ฺฉุฏ ุฌุฏุฏ</button>
            </div>
            
            <!-- Admin access hidden -->
        </div>
        
        <!-- Register Screen -->
        <div id="registerScreen" class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md mx-4 hidden">
            <div class="text-center mb-8">
                <div class="text-6xl mb-4">๐</div>
                <h1 class="text-3xl font-bold text-gray-800 mb-2">ุซุจุช ูุงู</h1>
                <p class="text-gray-600">ุงุฌุงุฏ ุญุณุงุจ ฺฉุงุฑุจุฑ ุฌุฏุฏ</p>
            </div>
            
            <form id="registerForm" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ูุงู ู ูุงู ุฎุงููุงุฏฺฏ</label>
                    <input type="text" id="registerName" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" placeholder="ูุงู ฺฉุงูู ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุดูุงุฑู ุชููู</label>
                    <input type="tel" id="registerPhone" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" placeholder="09xxxxxxxxx">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุงูู (ุงุฎุชุงุฑ)</label>
                    <input type="email" id="registerEmail" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" placeholder="example@email.com">
                </div>
                
                <button type="submit" class="w-full bg-green-500 hover:bg-green-600 text-white py-3 rounded-lg font-medium transition-all duration-200 shadow-md hover:shadow-lg">
                    ๐ค ุงุฑุณุงู ุฏุฑุฎูุงุณุช
                </button>
            </form>
            
            <div class="mt-6 text-center">
                <p class="text-gray-600">ุญุณุงุจ ฺฉุงุฑุจุฑ ุฏุงุฑุฏุ</p>
                <button onclick="showLoginScreen()" class="text-blue-500 hover:text-blue-600 font-medium">ูุงุฑุฏ ุดูุฏ</button>
            </div>
        </div>
        
        <!-- Code Activation Screen -->
        <div id="codeActivationScreen" class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md mx-4 hidden">
            <div class="text-center mb-8">
                <div class="text-6xl mb-4">๐</div>
                <h1 class="text-3xl font-bold text-gray-800 mb-2">ูุนุงูโุณุงุฒ ฺฉุฏ</h1>
                <p class="text-gray-600">ฺฉุฏ 12 ุฑูู ุฎูุฏ ุฑุง ูุนุงู ฺฉูุฏ</p>
            </div>
            
            <form id="codeActivationForm" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ฺฉุฏ 12 ุฑูู</label>
                    <input type="text" id="activationCode" required maxlength="12" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" placeholder="ฺฉุฏ ุฏุฑุงูุช ุงุฒ ูุฏุฑ">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุฑูุฒ ุนุจูุฑ ุฌุฏุฏ</label>
                    <input type="password" id="newPassword" required minlength="6" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" placeholder="ุญุฏุงูู 6 ฺฉุงุฑุงฺฉุชุฑ">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ุชฺฉุฑุงุฑ ุฑูุฒ ุนุจูุฑ</label>
                    <input type="password" id="confirmPassword" required minlength="6" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" placeholder="ุฑูุฒ ุนุจูุฑ ุฑุง ูุฌุฏุฏุงู ูุงุฑุฏ ฺฉูุฏ">
                </div>
                
                <button type="submit" class="w-full bg-purple-500 hover:bg-purple-600 text-white py-3 rounded-lg font-medium transition-all duration-200 shadow-md hover:shadow-lg">
                    โ ูุนุงูโุณุงุฒ ุญุณุงุจ
                </button>
            </form>
            
            <div class="mt-6 text-center">
                <button onclick="showLoginScreen()" class="text-blue-500 hover:text-blue-600 font-medium">ุจุงุฒฺฏุดุช ุจู ูุฑูุฏ</button>
            </div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="min-h-screen hidden">
        <!-- Admin Login -->
        <div id="adminLoginScreen" class="min-h-screen flex items-center justify-center">
            <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md mx-4">
                <div class="text-center mb-8">
                    <div class="text-6xl mb-4">๐</div>
                    <h1 class="text-3xl font-bold text-gray-800 mb-2">ูพูู ูุฏุฑุช</h1>
                    <p class="text-gray-600">ูุฑูุฏ ูุฏุฑ ุณุณุชู</p>
                </div>
                
                <form id="adminLoginForm" class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ูุงู ฺฉุงุฑุจุฑ</label>
                        <input type="text" id="adminUsername" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all" placeholder="ูุงู ฺฉุงุฑุจุฑ ูุฏุฑ">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ุฑูุฒ ุนุจูุฑ</label>
                        <input type="password" id="adminPassword" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all" placeholder="ุฑูุฒ ุนุจูุฑ ูุฏุฑ">
                    </div>
                    
                    <button type="submit" class="w-full bg-red-500 hover:bg-red-600 text-white py-3 rounded-lg font-medium transition-all duration-200 shadow-md hover:shadow-lg">
                        ๐ ูุฑูุฏ ูุฏุฑ
                    </button>
                </form>
                
                <div class="mt-6 text-center">
                    <button onclick="backToUserLogin()" class="text-blue-500 hover:text-blue-600 font-medium text-sm">ุจุงุฒฺฏุดุช ุจู ูุฑูุฏ ฺฉุงุฑุจุฑุงู</button>
                </div>
            </div>
        </div>
        
        <!-- Admin Dashboard -->
        <div id="adminDashboard" class="hidden">
            <header class="bg-red-600 shadow-lg">
                <div class="container mx-auto px-6 py-4">
                    <div class="flex justify-between items-center">
                        <h1 class="text-2xl font-bold text-white flex items-center">
                            <span class="text-3xl ml-3">๐</span>
                            ูพูู ูุฏุฑุช ุณุณุชู
                        </h1>
                        <div class="flex gap-3">
                            <button onclick="refreshAdminData()" class="bg-white bg-opacity-20 hover:bg-opacity-30 text-white px-4 py-2 rounded-lg transition-all">
                                ๐ ุจุฑูุฒุฑุณุงู
                            </button>
                            <button onclick="adminLogout()" class="bg-white bg-opacity-20 hover:bg-opacity-30 text-white px-4 py-2 rounded-lg transition-all">
                                ๐ช ุฎุฑูุฌ
                            </button>
                        </div>
                    </div>
                </div>
            </header>
            
            <div class="container mx-auto px-6 py-8">
                <!-- Admin Stats -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-gradient-to-r from-blue-400 to-blue-600 rounded-xl p-6 text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-blue-100">ฺฉู ฺฉุงุฑุจุฑุงู</p>
                                <p class="text-2xl font-bold" id="totalUsers">0</p>
                            </div>
                            <span class="text-4xl">๐ฅ</span>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-green-400 to-green-600 rounded-xl p-6 text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-green-100">ฺฉุงุฑุจุฑุงู ูุนุงู</p>
                                <p class="text-2xl font-bold" id="activeUsers">0</p>
                            </div>
                            <span class="text-4xl">โ</span>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-yellow-400 to-yellow-600 rounded-xl p-6 text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-yellow-100">ุฏุฑ ุงูุชุธุงุฑ ุชุงุฏ</p>
                                <p class="text-2xl font-bold" id="pendingUsers">0</p>
                            </div>
                            <span class="text-4xl">โณ</span>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-red-400 to-red-600 rounded-xl p-6 text-white">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-red-100">ฺฉุงุฑุจุฑุงู ูุณุฏูุฏ</p>
                                <p class="text-2xl font-bold" id="blockedUsers">0</p>
                            </div>
                            <span class="text-4xl">๐ซ</span>
                        </div>
                    </div>
                </div>
                
                <!-- Pending Registrations -->
                <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                        <span class="text-2xl ml-2">โณ</span>
                        ุฏุฑุฎูุงุณุชโูุง ุซุจุช ูุงู
                    </h2>
                    
                    <div id="pendingRegistrations">
                        <div class="text-center text-gray-500 py-8">
                            <span class="text-6xl">๐</span>
                            <p class="mt-4 text-lg">ุฏุฑุฎูุงุณุช ุฌุฏุฏ ูุฌูุฏ ูุฏุงุฑุฏ</p>
                        </div>
                    </div>
                </div>
                
                <!-- Subscription Management -->
                <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                        <span class="text-2xl ml-2">๐</span>
                        ูุฏุฑุช ุงุดุชุฑุงฺฉโูุง
                    </h2>
                    
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold text-gray-700 mb-4">ูุนุงูโุณุงุฒ ุงุดุชุฑุงฺฉ ุจุฑุง ฺฉุงุฑุจุฑ</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ุงูุชุฎุงุจ ฺฉุงุฑุจุฑ</label>
                                <select id="subscriptionUserId" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <option value="">ฺฉุงุฑุจุฑ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ููุน ุงุดุชุฑุงฺฉ</label>
                                <select id="subscriptionType" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <option value="">ููุน ุงุดุชุฑุงฺฉ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</option>
                                    <option value="1month">ฺฉ ูุงูู (นน ุชููุงู)</option>
                                    <option value="3month">ุณู ูุงูู (ฑนน ุชููุงู)</option>
                                    <option value="6month">ุดุด ูุงูู (ณนน ุชููุงู)</option>
                                    <option value="12month">ฺฉ ุณุงูู (ตนน ุชููุงู)</option>
                                    <option value="5year">ูพูุฌ ุณุงูู (ฑ,ตฐฐ ุชููุงู)</option>
                                    <option value="lifetime">ูุงูุญุฏูุฏ (ณ,ฐฐฐ ุชููุงู)</option>
                                </select>
                            </div>
                        </div>
                        <button onclick="activateUserSubscription()" class="mt-4 bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg font-medium transition-all">
                            โ ูุนุงูโุณุงุฒ ุงุดุชุฑุงฺฉ
                        </button>
                    </div>
                    
                    <div id="subscriptionsList">
                        <h3 class="text-lg font-semibold text-gray-700 mb-4">ูุณุช ุงุดุชุฑุงฺฉโูุง ูุนุงู</h3>
                        <div class="text-center text-gray-500 py-8">
                            <span class="text-6xl">๐</span>
                            <p class="mt-4 text-lg">ุงุดุชุฑุงฺฉ ูุนุงู ูุฌูุฏ ูุฏุงุฑุฏ</p>
                        </div>
                    </div>
                </div>

                <!-- User Management -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                        <span class="text-2xl ml-2">๐ฅ</span>
                        ูุฏุฑุช ฺฉุงุฑุจุฑุงู
                    </h2>
                    
                    <div id="usersList">
                        <div class="text-center text-gray-500 py-8">
                            <span class="text-6xl">๐ค</span>
                            <p class="mt-4 text-lg">ฺฉุงุฑุจุฑ ูุฌูุฏ ูุฏุงุฑุฏ</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="hidden">
    <!-- Header -->
    <header class="bg-white shadow-lg border-b-4 border-blue-500">
        <div class="container mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <h1 class="text-3xl font-bold text-gray-800 flex items-center">
                    <span class="text-4xl ml-3">๐ฐ</span>
                    ุงูพูฺฉุดู ุญุณุงุจุฏุงุฑ
                </h1>
                <div class="flex gap-3 items-center">
                    <div id="trialStatus" class="bg-yellow-100 border border-yellow-300 rounded-lg px-4 py-2 text-sm font-medium text-yellow-800">
                        <!-- Trial status will be populated by JavaScript -->
                    </div>
                    <select id="themeSelector" onchange="changeTheme()" class="bg-white border border-gray-300 rounded-lg px-4 py-2 text-sm font-medium">
                        <option value="light">๐ ุฑูุดู</option>
                        <option value="dark">๐ ุชุงุฑฺฉ</option>
                        <option value="purple">๐ ุจููุด</option>
                        <option value="gold">โจ ุทูุง</option>
                    </select>
                    <button onclick="showHelp()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-medium transition-all duration-200 shadow-md hover:shadow-lg">
                        โ ุฑุงูููุง
                    </button>
                    <button onclick="showSupport()" class="bg-purple-500 hover:bg-purple-600 text-white px-6 py-2 rounded-lg font-medium transition-all duration-200 shadow-md hover:shadow-lg">
                        ๐ง ูพุดุชุจุงู
                    </button>
                    <button onclick="showUserSubscriptionModal()" class="bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600 text-white px-6 py-2 rounded-lg font-medium transition-all duration-200 shadow-md hover:shadow-lg">
                        ๐ ุฎุฑุฏ ุงุดุชุฑุงฺฉ
                    </button>
                    <button onclick="exportToPDF()" class="bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-lg font-medium transition-all duration-200 shadow-md hover:shadow-lg">
                        ๐ ุฏุงูููุฏ PDF
                    </button>
                    <button onclick="shareData()" class="bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-lg font-medium transition-all duration-200 shadow-md hover:shadow-lg">
                        ๐ค ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ
                    </button>
                    <button onclick="userLogout()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg font-medium transition-all duration-200 shadow-md hover:shadow-lg">
                        ๐ช ุฎุฑูุฌ
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-6 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Add Person Form -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-200">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                        <span class="text-2xl ml-2">๐ค</span>
                        ุงูุฒูุฏู ุดุฎุต ุฌุฏุฏ
                    </h2>
                    
                    <form id="personForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ูุงู ู ูุงู ุฎุงููุงุฏฺฏ</label>
                            <input type="text" id="personName" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ุดูุงุฑู ุชููู</label>
                            <input type="tel" id="personPhone" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ุขุฏุฑุณ</label>
                            <textarea id="personAddress" rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ุนฺฉุณ ูพุฑููุงู</label>
                            <input type="file" id="personPhoto" accept="image/*" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        </div>
                        
                        <button type="submit" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-lg font-medium transition-all duration-200 shadow-md hover:shadow-lg">
                            โ ุงูุฒูุฏู ุดุฎุต
                        </button>
                    </form>
                </div>

                <!-- Transaction Form -->
                <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-200 mt-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                        <span class="text-2xl ml-2">๐ธ</span>
                        ุซุจุช ุชุฑุงฺฉูุด
                    </h2>
                    
                    <form id="transactionForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ุงูุชุฎุงุจ ุดุฎุต</label>
                            <select id="transactionPerson" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                                <option value="">ุดุฎุต ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ููุน ุชุฑุงฺฉูุด</label>
                            <select id="transactionType" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                                <option value="">ููุน ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</option>
                                <option value="debt">ุจุฏูฺฉุงุฑ (ูู ุจู ุงู ุจุฏูฺฉุงุฑู)</option>
                                <option value="credit">ุทูุจฺฉุงุฑ (ุงู ุจู ูู ุจุฏูฺฉุงุฑ ุงุณุช)</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ูุจูุบ (ุชููุงู)</label>
                            <input type="number" id="transactionAmount" required min="0" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ุชูุถุญุงุช</label>
                            <textarea id="transactionDescription" rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"></textarea>
                        </div>
                        
                        <button type="submit" class="w-full bg-green-500 hover:bg-green-600 text-white py-3 rounded-lg font-medium transition-all duration-200 shadow-md hover:shadow-lg">
                            ๐ฐ ุซุจุช ุชุฑุงฺฉูุด
                        </button>
                    </form>
                </div>
            </div>

            <!-- People List and Transactions -->
            <div class="lg:col-span-2">
                <!-- Summary Cards -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
                    <div class="bg-gradient-to-r from-green-400 to-green-600 rounded-xl p-6 text-white shadow-lg">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-green-100 text-sm">ฺฉู ุทูุจ</p>
                                <p class="text-2xl font-bold" id="totalCredit">0</p>
                            </div>
                            <span class="text-4xl">๐</span>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-red-400 to-red-600 rounded-xl p-6 text-white shadow-lg">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-red-100 text-sm">ฺฉู ุจุฏู</p>
                                <p class="text-2xl font-bold" id="totalDebt">0</p>
                            </div>
                            <span class="text-4xl">๐</span>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-blue-400 to-blue-600 rounded-xl p-6 text-white shadow-lg">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-blue-100 text-sm">ุชุนุฏุงุฏ ุงุดุฎุงุต</p>
                                <p class="text-2xl font-bold" id="totalPeople">0</p>
                            </div>
                            <span class="text-4xl">๐ฅ</span>
                        </div>
                    </div>
                </div>

                <!-- People List -->
                <div class="theme-bg-secondary rounded-xl shadow-lg p-6 border border-gray-200">
                    <h2 class="text-2xl font-bold theme-text-primary mb-6 flex items-center">
                        <span class="text-2xl ml-2">๐</span>
                        ูุณุช ุงุดุฎุงุต ู ุญุณุงุจโูุง
                    </h2>
                    
                    <div id="peopleList" class="space-y-4">
                        <div class="text-center text-gray-500 py-8">
                            <span class="text-6xl">๐ค</span>
                            <p class="mt-4 text-lg">ูููุฒ ุดุฎุต ุงุถุงูู ูุดุฏู ุงุณุช</p>
                            <p class="text-sm text-gray-400">ุงุฒ ูุฑู ุณูุช ุฑุงุณุช ุดุฎุต ุฌุฏุฏ ุงุถุงูู ฺฉูุฏ</p>
                        </div>
                    </div>
                </div>

                <!-- 3D Charts -->
                <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-200 mt-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                        <span class="text-2xl ml-2">๐</span>
                        ูููุฏุงุฑูุง ุณู ุจุนุฏ
                    </h2>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">ูููุฏุงุฑ ุฏุงุฑูโุง ุจุฏู/ุทูุจ</h3>
                            <div id="pieChart" style="height: 400px;"></div>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700 mb-4">ูููุฏุงุฑ ุณุชูู ููุฌูุฏ ุงุดุฎุงุต</h3>
                            <div id="barChart" style="height: 400px;"></div>
                        </div>
                    </div>
                    
                    <div class="mt-6">
                        <h3 class="text-lg font-semibold text-gray-700 mb-4">ูููุฏุงุฑ ุณู ุจุนุฏ ุชุฑุงฺฉูุดโูุง ุฏุฑ ุทูู ุฒูุงู</h3>
                        <div id="surface3D" style="height: 500px;"></div>
                    </div>
                </div>

                <!-- Individual Person Tables -->
                <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-200 mt-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                        <span class="text-2xl ml-2">๐</span>
                        ุฌุฏุงูู ุฌุฒุฆุงุช ูุฑ ูุฑุฏ
                    </h2>
                    
                    <div id="individualTables">
                        <div class="text-center text-gray-500 py-8">
                            <span class="text-6xl">๐</span>
                            <p class="mt-4 text-lg">ูููุฒ ุดุฎุต ุงุถุงูู ูุดุฏู ุงุณุช</p>
                            <p class="text-sm text-gray-400">ูพุณ ุงุฒ ุงูุฒูุฏู ุงุดุฎุงุตุ ุฌุฏุงูู ุฌุฒุฆุงุช ููุงุด ุฏุงุฏู ูโุดูุฏ</p>
                        </div>
                    </div>
                </div>

                <!-- Transactions List -->
                <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-200 mt-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                        <span class="text-2xl ml-2">๐ธ</span>
                        ุชุงุฑุฎฺู ุชุฑุงฺฉูุดโูุง
                    </h2>
                    
                    <div id="transactionsList" class="space-y-3">
                        <div class="text-center text-gray-500 py-8">
                            <span class="text-6xl">๐ธ</span>
                            <p class="mt-4 text-lg">ูููุฒ ุชุฑุงฺฉูุด ุซุจุช ูุดุฏู ุงุณุช</p>
                            <p class="text-sm text-gray-400">ุงุฒ ูุฑู ุณูุช ุฑุงุณุช ุชุฑุงฺฉูุด ุฌุฏุฏ ุงุถุงูู ฺฉูุฏ</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="helpModal" class="modal">
        <div class="modal-content theme-bg-secondary theme-text-primary">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">๐ ุฑุงูููุง ุงุณุชูุงุฏู</h2>
                <button onclick="closeModal('helpModal')" class="text-2xl hover:opacity-70">&times;</button>
            </div>
            
            <div class="space-y-6">
                <div>
                    <h3 class="text-lg font-semibold mb-3 flex items-center">
                        <span class="ml-2">๐ค</span>
                        ุงูุฒูุฏู ุดุฎุต ุฌุฏุฏ
                    </h3>
                    <p class="theme-text-secondary">ูุงูุ ุดูุงุฑู ุชูููุ ุขุฏุฑุณ ู ุนฺฉุณ ุดุฎุต ุฑุง ูุงุฑุฏ ฺฉูุฏ. ุชููุง ูุงู ุงุฌุจุงุฑ ุงุณุช.</p>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-3 flex items-center">
                        <span class="ml-2">๐ธ</span>
                        ุซุจุช ุชุฑุงฺฉูุด
                    </h3>
                    <p class="theme-text-secondary">ุดุฎุตุ ููุน ุชุฑุงฺฉูุด (ุจุฏูฺฉุงุฑ/ุทูุจฺฉุงุฑ) ู ูุจูุบ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ. ุชูุถุญุงุช ุงุฎุชุงุฑ ุงุณุช.</p>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-3 flex items-center">
                        <span class="ml-2">๐</span>
                        ฺฏุฒุงุฑุด ูุฑุฏ
                    </h3>
                    <p class="theme-text-secondary">ุฑู ุฏฺฉูู "ฺฏุฒุงุฑุด" ฺฉูุงุฑ ูุฑ ุดุฎุต ฺฉูฺฉ ฺฉูุฏ ุชุง ฺฏุฒุงุฑุด ฺฉุงูู ุงู ุฑุง ุจุจูุฏ ู ุฏุงูููุฏ ฺฉูุฏ.</p>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-3 flex items-center">
                        <span class="ml-2">๐จ</span>
                        ุชุบุฑ ุชู
                    </h3>
                    <p class="theme-text-secondary">ุงุฒ ููู ุจุงูุง ุตูุญู ูโุชูุงูุฏ ุจู ุชูโูุง ูุฎุชูู (ุฑูุดูุ ุชุงุฑฺฉุ ุจููุดุ ุทูุง) ุงูุชุฎุงุจ ฺฉูุฏ.</p>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-3 flex items-center">
                        <span class="ml-2">๐ค</span>
                        ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ
                    </h3>
                    <p class="theme-text-secondary">ฺฏุฒุงุฑุดโูุง ุฑุง ูโุชูุงูุฏ ุฏุฑ ุชูฺฏุฑุงูุ ูุงุชุณุงูพุ ุงุชุง ู ุณุงุฑ ูพูุชูุฑูโูุง ุจู ุงุดุชุฑุงฺฉ ุจฺฏุฐุงุฑุฏ.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Support Modal -->
    <div id="supportModal" class="modal">
        <div class="modal-content theme-bg-secondary theme-text-primary">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">๐ง ูพุดุชุจุงู ู ุงุฑุชุจุงุท ุจุง ูุง</h2>
                <button onclick="closeModal('supportModal')" class="text-2xl hover:opacity-70">&times;</button>
            </div>
            
            <div class="space-y-6">
                <div class="text-center mb-8">
                    <div class="text-6xl mb-4">๐๏ธ</div>
                    <h3 class="text-xl font-bold theme-text-primary mb-2">ุชู ูพุดุชุจุงู ุขูุงุฏู ฺฉูฺฉ ุจู ุดูุงุณุช</h3>
                    <p class="theme-text-secondary">ุจุฑุง ูุฑฺฏููู ุณูุงูุ ูุดฺฉู ุง ูพุดููุงุฏ ุจุง ูุง ุฏุฑ ุงุฑุชุจุงุท ุจุงุดุฏ</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- Phone Support -->
                    <div class="bg-gradient-to-r from-blue-50 to-blue-100 rounded-xl p-6 text-center hover:shadow-lg transition-all duration-200 cursor-pointer" onclick="contactSupport('phone')">
                        <div class="text-4xl mb-3">
                            <svg class="w-12 h-12 mx-auto text-blue-600" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/>
                            </svg>
                        </div>
                        <h4 class="font-bold text-blue-800 mb-2">ุชูุงุณ ุชููู</h4>
                        <p class="text-blue-600 font-medium">ฐนนณถตถตตฑฐถ</p>
                        <p class="text-sm text-blue-500 mt-2">ูพุงุณุฎฺฏู ฒด ุณุงุนุชู</p>
                    </div>
                    
                    <!-- Telegram Support -->
                    <div class="bg-gradient-to-r from-blue-400 to-blue-500 rounded-xl p-6 text-center text-white hover:shadow-lg transition-all duration-200 cursor-pointer" onclick="contactSupport('telegram')">
                        <div class="text-4xl mb-3">
                            <svg class="w-12 h-12 mx-auto text-white" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                            </svg>
                        </div>
                        <h4 class="font-bold mb-2">ุชูฺฏุฑุงู</h4>
                        <p class="font-medium">@Spaincar7</p>
                        <p class="text-sm text-blue-100 mt-2">ูพุงุณุฎ ุณุฑุน ู ุขููุงู</p>
                    </div>
                    
                    <!-- WhatsApp Support -->
                    <div class="bg-gradient-to-r from-green-400 to-green-500 rounded-xl p-6 text-center text-white hover:shadow-lg transition-all duration-200 cursor-pointer" onclick="contactSupport('whatsapp')">
                        <div class="text-4xl mb-3">
                            <svg class="w-12 h-12 mx-auto text-white" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"/>
                            </svg>
                        </div>
                        <h4 class="font-bold mb-2">ูุงุชุณุงูพ</h4>
                        <p class="font-medium">ฐนฑนนทถดฑตท</p>
                        <p class="text-sm text-green-100 mt-2">ฺุช ู ุชูุงุณ ุตูุช</p>
                    </div>
                    
                    <!-- Eitaa Support -->
                    <div class="bg-gradient-to-r from-purple-400 to-purple-500 rounded-xl p-6 text-center text-white hover:shadow-lg transition-all duration-200 cursor-pointer" onclick="contactSupport('eitaa')">
                        <div class="text-4xl mb-3">
                            <svg class="w-12 h-12 mx-auto text-white" fill="currentColor" viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/>
                                <path d="M8 12h8M12 8v8" stroke="currentColor" stroke-width="2"/>
                                <text x="12" y="16" text-anchor="middle" font-size="8" fill="currentColor">ุงุชุง</text>
                            </svg>
                        </div>
                        <h4 class="font-bold mb-2">ุงุชุง</h4>
                        <p class="font-medium">@Spaincar77</p>
                        <p class="text-sm text-purple-100 mt-2">ูพุงูโุฑุณุงู ุฏุงุฎู</p>
                    </div>
                </div>
                
                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mt-6">
                    <div class="flex items-center mb-3">
                        <span class="text-2xl ml-2">๐ก</span>
                        <h4 class="font-bold text-yellow-800">ูฺฉุงุช ููู:</h4>
                    </div>
                    <ul class="text-yellow-700 text-sm space-y-2">
                        <li>โข ูุจู ุงุฒ ุชูุงุณุ ูุทูุงู ุงุฒ ุจุฎุด ุฑุงูููุง ุงุณุชูุงุฏู ฺฉูุฏ</li>
                        <li>โข ุจุฑุง ฺฏุฒุงุฑุด ูุดฺฉูุ ุงุณฺฉุฑูโุดุงุช ุงุฑุณุงู ฺฉูุฏ</li>
                        <li>โข ูพุดููุงุฏุงุช ุดูุง ุจุฑุง ุจูุจูุฏ ุจุฑูุงูู ุงุฑุฒุดููุฏ ุงุณุช</li>
                        <li>โข ุฒูุงู ูพุงุณุฎฺฏู: ุดูุจู ุชุง ูพูุฌโุดูุจู น ุชุง ฒฑ</li>
                    </ul>
                </div>
                
                <div class="text-center">
                    <p class="text-sm theme-text-secondary">
                        ๐ ุฑุถุงุช ุดูุง ุงูููุช ูุงุณุช ๐
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Subscription Modal -->
    <div id="subscriptionModal" class="modal">
        <div class="modal-content theme-bg-secondary theme-text-primary max-w-4xl">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-3xl font-bold flex items-center">
                    <span class="text-3xl ml-3">๐</span>
                    ูพูุงูโูุง ุงุดุชุฑุงฺฉ
                </h2>
                <button onclick="closeModal('subscriptionModal')" class="text-2xl hover:opacity-70">&times;</button>
            </div>
            
            <div class="mb-8 text-center">
                <div class="bg-gradient-to-r from-red-100 to-red-200 border border-red-300 rounded-lg p-4 mb-6">
                    <div class="flex items-center justify-center mb-2">
                        <span class="text-3xl ml-2">โฐ</span>
                        <h3 class="text-xl font-bold text-red-800">ุฏูุฑู ุขุฒูุงุด ุจู ูพุงุงู ุฑุณุฏ!</h3>
                    </div>
                    <p class="text-red-700">ุจุฑุง ุงุฏุงูู ุงุณุชูุงุฏู ุงุฒ ุชูุงู ุงูฺฉุงูุงุชุ ูุทูุงู ฺฉ ุงุฒ ูพูุงูโูุง ุฒุฑ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</p>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                <!-- 1 Month Plan -->
                <div class="border-2 border-blue-200 rounded-xl p-6 hover:shadow-lg transition-all duration-200 bg-gradient-to-b from-blue-50 to-blue-100">
                    <div class="text-center">
                        <div class="text-4xl mb-3">๐</div>
                        <h3 class="text-xl font-bold text-blue-800 mb-2">ฺฉ ูุงูู</h3>
                        <div class="text-3xl font-bold text-blue-600 mb-4">นน ุชููุงู</div>
                        <ul class="text-sm text-blue-700 space-y-2 mb-6">
                            <li>โ ุชูุงู ุงูฺฉุงูุงุช</li>
                            <li>โ ูุงูุญุฏูุฏ ุชุฑุงฺฉูุด</li>
                            <li>โ ฺฏุฒุงุฑุดโฺฏุฑ PDF</li>
                            <li>โ ูพุดุชุจุงู ุขููุงู</li>
                        </ul>
                        <button onclick="purchaseSubscription('1month')" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-lg font-medium transition-all">
                            ุฎุฑุฏ ุงุดุชุฑุงฺฉ
                        </button>
                    </div>
                </div>
                
                <!-- 3 Month Plan -->
                <div class="border-2 border-green-200 rounded-xl p-6 hover:shadow-lg transition-all duration-200 bg-gradient-to-b from-green-50 to-green-100">
                    <div class="text-center">
                        <div class="text-4xl mb-3">๐</div>
                        <h3 class="text-xl font-bold text-green-800 mb-2">ุณู ูุงูู</h3>
                        <div class="text-3xl font-bold text-green-600 mb-2">ฑนน ุชููุงู</div>
                        <div class="text-sm text-green-500 mb-4">ุตุฑููโุฌู นธ ุชููุงู</div>
                        <ul class="text-sm text-green-700 space-y-2 mb-6">
                            <li>โ ุชูุงู ุงูฺฉุงูุงุช</li>
                            <li>โ ูุงูุญุฏูุฏ ุชุฑุงฺฉูุด</li>
                            <li>โ ฺฏุฒุงุฑุดโฺฏุฑ PDF</li>
                            <li>โ ูพุดุชุจุงู ุงูููุชโุฏุงุฑ</li>
                        </ul>
                        <button onclick="purchaseSubscription('3month')" class="w-full bg-green-500 hover:bg-green-600 text-white py-3 rounded-lg font-medium transition-all">
                            ุฎุฑุฏ ุงุดุชุฑุงฺฉ
                        </button>
                    </div>
                </div>
                
                <!-- 6 Month Plan -->
                <div class="border-2 border-purple-200 rounded-xl p-6 hover:shadow-lg transition-all duration-200 bg-gradient-to-b from-purple-50 to-purple-100">
                    <div class="text-center">
                        <div class="text-4xl mb-3">๐</div>
                        <h3 class="text-xl font-bold text-purple-800 mb-2">ุดุด ูุงูู</h3>
                        <div class="text-3xl font-bold text-purple-600 mb-2">ณนน ุชููุงู</div>
                        <div class="text-sm text-purple-500 mb-4">ุตุฑููโุฌู ฑนต ุชููุงู</div>
                        <ul class="text-sm text-purple-700 space-y-2 mb-6">
                            <li>โ ุชูุงู ุงูฺฉุงูุงุช</li>
                            <li>โ ูุงูุญุฏูุฏ ุชุฑุงฺฉูุด</li>
                            <li>โ ฺฏุฒุงุฑุดโฺฏุฑ PDF</li>
                            <li>โ ูพุดุชุจุงู VIP</li>
                        </ul>
                        <button onclick="purchaseSubscription('6month')" class="w-full bg-purple-500 hover:bg-purple-600 text-white py-3 rounded-lg font-medium transition-all">
                            ุฎุฑุฏ ุงุดุชุฑุงฺฉ
                        </button>
                    </div>
                </div>
                
                <!-- 12 Month Plan -->
                <div class="border-2 border-yellow-200 rounded-xl p-6 hover:shadow-lg transition-all duration-200 bg-gradient-to-b from-yellow-50 to-yellow-100 relative">
                    <div class="absolute -top-3 left-1/2 transform -translate-x-1/2">
                        <span class="bg-yellow-500 text-white px-4 py-1 rounded-full text-sm font-bold">ูุญุจูุจ</span>
                    </div>
                    <div class="text-center">
                        <div class="text-4xl mb-3">๐</div>
                        <h3 class="text-xl font-bold text-yellow-800 mb-2">ฺฉ ุณุงูู</h3>
                        <div class="text-3xl font-bold text-yellow-600 mb-2">ตนน ุชููุงู</div>
                        <div class="text-sm text-yellow-500 mb-4">ุตุฑููโุฌู ตธน ุชููุงู</div>
                        <ul class="text-sm text-yellow-700 space-y-2 mb-6">
                            <li>โ ุชูุงู ุงูฺฉุงูุงุช</li>
                            <li>โ ูุงูุญุฏูุฏ ุชุฑุงฺฉูุด</li>
                            <li>โ ฺฏุฒุงุฑุดโฺฏุฑ PDF</li>
                            <li>โ ูพุดุชุจุงู ุงุฎุชุตุงุต</li>
                            <li>โ ุขูพุฏุชโูุง ุฑุงฺฏุงู</li>
                        </ul>
                        <button onclick="purchaseSubscription('12month')" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white py-3 rounded-lg font-medium transition-all">
                            ุฎุฑุฏ ุงุดุชุฑุงฺฉ
                        </button>
                    </div>
                </div>
                
                <!-- 5 Year Plan -->
                <div class="border-2 border-indigo-200 rounded-xl p-6 hover:shadow-lg transition-all duration-200 bg-gradient-to-b from-indigo-50 to-indigo-100">
                    <div class="text-center">
                        <div class="text-4xl mb-3">๐</div>
                        <h3 class="text-xl font-bold text-indigo-800 mb-2">ูพูุฌ ุณุงูู</h3>
                        <div class="text-3xl font-bold text-indigo-600 mb-2">ฑ,ตฐฐ ุชููุงู</div>
                        <div class="text-sm text-indigo-500 mb-4">ุตุฑููโุฌู ฒ,ดทต ุชููุงู</div>
                        <ul class="text-sm text-indigo-700 space-y-2 mb-6">
                            <li>โ ุชูุงู ุงูฺฉุงูุงุช</li>
                            <li>โ ูุงูุญุฏูุฏ ุชุฑุงฺฉูุด</li>
                            <li>โ ฺฏุฒุงุฑุดโฺฏุฑ PDF</li>
                            <li>โ ูพุดุชุจุงู ุงุฎุชุตุงุต</li>
                            <li>โ ุขูพุฏุชโูุง ุฑุงฺฏุงู</li>
                            <li>โ ุงูฺฉุงูุงุช ูฺู</li>
                        </ul>
                        <button onclick="purchaseSubscription('5year')" class="w-full bg-indigo-500 hover:bg-indigo-600 text-white py-3 rounded-lg font-medium transition-all">
                            ุฎุฑุฏ ุงุดุชุฑุงฺฉ
                        </button>
                    </div>
                </div>
                
                <!-- Lifetime Plan -->
                <div class="border-2 border-red-200 rounded-xl p-6 hover:shadow-lg transition-all duration-200 bg-gradient-to-b from-red-50 to-red-100 relative">
                    <div class="absolute -top-3 left-1/2 transform -translate-x-1/2">
                        <span class="bg-red-500 text-white px-4 py-1 rounded-full text-sm font-bold">ุจูุชุฑู ุงุฑุฒุด</span>
                    </div>
                    <div class="text-center">
                        <div class="text-4xl mb-3">โพ๏ธ</div>
                        <h3 class="text-xl font-bold text-red-800 mb-2">ูุงูุญุฏูุฏ</h3>
                        <div class="text-3xl font-bold text-red-600 mb-2">ณ,ฐฐฐ ุชููุงู</div>
                        <div class="text-sm text-red-500 mb-4">ฺฉุจุงุฑ ูพุฑุฏุงุฎุช - ูุงุฏุงูโุงูุนูุฑ</div>
                        <ul class="text-sm text-red-700 space-y-2 mb-6">
                            <li>โ ุชูุงู ุงูฺฉุงูุงุช</li>
                            <li>โ ูุงูุญุฏูุฏ ุชุฑุงฺฉูุด</li>
                            <li>โ ฺฏุฒุงุฑุดโฺฏุฑ PDF</li>
                            <li>โ ูพุดุชุจุงู ูุงุฏุงูโุงูุนูุฑ</li>
                            <li>โ ุชูุงู ุขูพุฏุชโูุง ุฑุงฺฏุงู</li>
                            <li>โ ุงูฺฉุงูุงุช ูฺู ู ุฌุฏุฏ</li>
                            <li>โ ุจุฏูู ุชุงุฑุฎ ุงููุถุง</li>
                        </ul>
                        <button onclick="purchaseSubscription('lifetime')" class="w-full bg-red-500 hover:bg-red-600 text-white py-3 rounded-lg font-medium transition-all">
                            ุฎุฑุฏ ุงุดุชุฑุงฺฉ
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="bg-gradient-to-r from-blue-100 to-purple-100 border border-blue-200 rounded-lg p-6">
                <div class="text-center">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center justify-center">
                        <span class="text-2xl ml-2">๐ง</span>
                        ูุญูู ุฎุฑุฏ ุงุดุชุฑุงฺฉ
                    </h3>
                    <p class="text-gray-700 mb-4">ุจุฑุง ุฎุฑุฏ ุงุดุชุฑุงฺฉุ ุจุง ุชู ูพุดุชุจุงู ูุง ุชูุงุณ ุจฺฏุฑุฏ:</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <button onclick="contactSupport('phone')" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-3 rounded-lg transition-all flex items-center justify-center">
                            ๐ ฐนนณถตถตตฑฐถ
                        </button>
                        <button onclick="contactSupport('telegram')" class="bg-blue-400 hover:bg-blue-500 text-white px-4 py-3 rounded-lg transition-all flex items-center justify-center">
                            ๐ฑ @Spaincar7
                        </button>
                        <button onclick="contactSupport('whatsapp')" class="bg-green-500 hover:bg-green-600 text-white px-4 py-3 rounded-lg transition-all flex items-center justify-center">
                            ๐ฌ ฐนฑนนทถดฑตท
                        </button>
                        <button onclick="contactSupport('eitaa')" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-3 rounded-lg transition-all flex items-center justify-center">
                            ๐ต @Spaincar77
                        </button>
                    </div>
                    
                    <div class="mt-4 text-sm text-gray-600">
                        <p>โฐ ูพุดุชุจุงู: ุดูุจู ุชุง ูพูุฌโุดูุจู น ุชุง ฒฑ</p>
                        <p>๐ณ ูพุฑุฏุงุฎุช: ฺฉุงุฑุช ุจู ฺฉุงุฑุชุ ุฏุฑฺฏุงู ุจุงูฺฉ</p>
                        <p>โก ูุนุงูโุณุงุฒ: ููุฑ ูพุณ ุงุฒ ูพุฑุฏุงุฎุช</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- User Subscription Modal -->
    <div id="userSubscriptionModal" class="modal">
        <div class="modal-content theme-bg-secondary theme-text-primary max-w-5xl">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-3xl font-bold flex items-center">
                    <span class="text-3xl ml-3">๐</span>
                    ุฎุฑุฏ ุงุดุชุฑุงฺฉ ุญุณุงุจุฏุงุฑ
                </h2>
                <button onclick="closeModal('userSubscriptionModal')" class="text-2xl hover:opacity-70">&times;</button>
            </div>
            
            <!-- Current Status -->
            <div class="mb-8 text-center">
                <div id="currentSubscriptionStatus" class="bg-gradient-to-r from-blue-100 to-purple-100 border border-blue-200 rounded-lg p-4 mb-6">
                    <!-- Status will be populated by JavaScript -->
                </div>
            </div>
            
            <!-- Subscription Plans -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                <!-- 1 Month Plan -->
                <div class="border-2 border-blue-200 rounded-xl p-6 hover:shadow-lg transition-all duration-200 bg-gradient-to-b from-blue-50 to-blue-100">
                    <div class="text-center">
                        <div class="text-4xl mb-3">๐</div>
                        <h3 class="text-xl font-bold text-blue-800 mb-2">ฺฉ ูุงูู</h3>
                        <div class="text-3xl font-bold text-blue-600 mb-4">นน ุชููุงู</div>
                        <ul class="text-sm text-blue-700 space-y-2 mb-6">
                            <li>โ ุชูุงู ุงูฺฉุงูุงุช</li>
                            <li>โ ูุงูุญุฏูุฏ ุชุฑุงฺฉูุด</li>
                            <li>โ ฺฏุฒุงุฑุดโฺฏุฑ PDF</li>
                            <li>โ ูพุดุชุจุงู ุขููุงู</li>
                        </ul>
                        <button onclick="purchaseUserSubscription('1month')" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-lg font-medium transition-all">
                            ุงูุชุฎุงุจ ุงู ูพูุงู
                        </button>
                    </div>
                </div>
                
                <!-- 3 Month Plan -->
                <div class="border-2 border-green-200 rounded-xl p-6 hover:shadow-lg transition-all duration-200 bg-gradient-to-b from-green-50 to-green-100">
                    <div class="text-center">
                        <div class="text-4xl mb-3">๐</div>
                        <h3 class="text-xl font-bold text-green-800 mb-2">ุณู ูุงูู</h3>
                        <div class="text-3xl font-bold text-green-600 mb-2">ฑนน ุชููุงู</div>
                        <div class="text-sm text-green-500 mb-4">ุตุฑููโุฌู นธ ุชููุงู</div>
                        <ul class="text-sm text-green-700 space-y-2 mb-6">
                            <li>โ ุชูุงู ุงูฺฉุงูุงุช</li>
                            <li>โ ูุงูุญุฏูุฏ ุชุฑุงฺฉูุด</li>
                            <li>โ ฺฏุฒุงุฑุดโฺฏุฑ PDF</li>
                            <li>โ ูพุดุชุจุงู ุงูููุชโุฏุงุฑ</li>
                        </ul>
                        <button onclick="purchaseUserSubscription('3month')" class="w-full bg-green-500 hover:bg-green-600 text-white py-3 rounded-lg font-medium transition-all">
                            ุงูุชุฎุงุจ ุงู ูพูุงู
                        </button>
                    </div>
                </div>
                
                <!-- 6 Month Plan -->
                <div class="border-2 border-purple-200 rounded-xl p-6 hover:shadow-lg transition-all duration-200 bg-gradient-to-b from-purple-50 to-purple-100">
                    <div class="text-center">
                        <div class="text-4xl mb-3">๐</div>
                        <h3 class="text-xl font-bold text-purple-800 mb-2">ุดุด ูุงูู</h3>
                        <div class="text-3xl font-bold text-purple-600 mb-2">ณนน ุชููุงู</div>
                        <div class="text-sm text-purple-500 mb-4">ุตุฑููโุฌู ฑนต ุชููุงู</div>
                        <ul class="text-sm text-purple-700 space-y-2 mb-6">
                            <li>โ ุชูุงู ุงูฺฉุงูุงุช</li>
                            <li>โ ูุงูุญุฏูุฏ ุชุฑุงฺฉูุด</li>
                            <li>โ ฺฏุฒุงุฑุดโฺฏุฑ PDF</li>
                            <li>โ ูพุดุชุจุงู VIP</li>
                        </ul>
                        <button onclick="purchaseUserSubscription('6month')" class="w-full bg-purple-500 hover:bg-purple-600 text-white py-3 rounded-lg font-medium transition-all">
                            ุงูุชุฎุงุจ ุงู ูพูุงู
                        </button>
                    </div>
                </div>
                
                <!-- 12 Month Plan -->
                <div class="border-2 border-yellow-200 rounded-xl p-6 hover:shadow-lg transition-all duration-200 bg-gradient-to-b from-yellow-50 to-yellow-100 relative">
                    <div class="absolute -top-3 left-1/2 transform -translate-x-1/2">
                        <span class="bg-yellow-500 text-white px-4 py-1 rounded-full text-sm font-bold">ูุญุจูุจ</span>
                    </div>
                    <div class="text-center">
                        <div class="text-4xl mb-3">๐</div>
                        <h3 class="text-xl font-bold text-yellow-800 mb-2">ฺฉ ุณุงูู</h3>
                        <div class="text-3xl font-bold text-yellow-600 mb-2">ตนน ุชููุงู</div>
                        <div class="text-sm text-yellow-500 mb-4">ุตุฑููโุฌู ตธน ุชููุงู</div>
                        <ul class="text-sm text-yellow-700 space-y-2 mb-6">
                            <li>โ ุชูุงู ุงูฺฉุงูุงุช</li>
                            <li>โ ูุงูุญุฏูุฏ ุชุฑุงฺฉูุด</li>
                            <li>โ ฺฏุฒุงุฑุดโฺฏุฑ PDF</li>
                            <li>โ ูพุดุชุจุงู ุงุฎุชุตุงุต</li>
                            <li>โ ุขูพุฏุชโูุง ุฑุงฺฏุงู</li>
                        </ul>
                        <button onclick="purchaseUserSubscription('12month')" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white py-3 rounded-lg font-medium transition-all">
                            ุงูุชุฎุงุจ ุงู ูพูุงู
                        </button>
                    </div>
                </div>
                
                <!-- 5 Year Plan -->
                <div class="border-2 border-indigo-200 rounded-xl p-6 hover:shadow-lg transition-all duration-200 bg-gradient-to-b from-indigo-50 to-indigo-100">
                    <div class="text-center">
                        <div class="text-4xl mb-3">๐</div>
                        <h3 class="text-xl font-bold text-indigo-800 mb-2">ูพูุฌ ุณุงูู</h3>
                        <div class="text-3xl font-bold text-indigo-600 mb-2">ฑ,ตฐฐ ุชููุงู</div>
                        <div class="text-sm text-indigo-500 mb-4">ุตุฑููโุฌู ฒ,ดทต ุชููุงู</div>
                        <ul class="text-sm text-indigo-700 space-y-2 mb-6">
                            <li>โ ุชูุงู ุงูฺฉุงูุงุช</li>
                            <li>โ ูุงูุญุฏูุฏ ุชุฑุงฺฉูุด</li>
                            <li>โ ฺฏุฒุงุฑุดโฺฏุฑ PDF</li>
                            <li>โ ูพุดุชุจุงู ุงุฎุชุตุงุต</li>
                            <li>โ ุขูพุฏุชโูุง ุฑุงฺฏุงู</li>
                            <li>โ ุงูฺฉุงูุงุช ูฺู</li>
                        </ul>
                        <button onclick="purchaseUserSubscription('5year')" class="w-full bg-indigo-500 hover:bg-indigo-600 text-white py-3 rounded-lg font-medium transition-all">
                            ุงูุชุฎุงุจ ุงู ูพูุงู
                        </button>
                    </div>
                </div>
                
                <!-- Lifetime Plan -->
                <div class="border-2 border-red-200 rounded-xl p-6 hover:shadow-lg transition-all duration-200 bg-gradient-to-b from-red-50 to-red-100 relative">
                    <div class="absolute -top-3 left-1/2 transform -translate-x-1/2">
                        <span class="bg-red-500 text-white px-4 py-1 rounded-full text-sm font-bold">ุจูุชุฑู ุงุฑุฒุด</span>
                    </div>
                    <div class="text-center">
                        <div class="text-4xl mb-3">โพ๏ธ</div>
                        <h3 class="text-xl font-bold text-red-800 mb-2">ูุงูุญุฏูุฏ</h3>
                        <div class="text-3xl font-bold text-red-600 mb-2">ณ,ฐฐฐ ุชููุงู</div>
                        <div class="text-sm text-red-500 mb-4">ฺฉุจุงุฑ ูพุฑุฏุงุฎุช - ูุงุฏุงูโุงูุนูุฑ</div>
                        <ul class="text-sm text-red-700 space-y-2 mb-6">
                            <li>โ ุชูุงู ุงูฺฉุงูุงุช</li>
                            <li>โ ูุงูุญุฏูุฏ ุชุฑุงฺฉูุด</li>
                            <li>โ ฺฏุฒุงุฑุดโฺฏุฑ PDF</li>
                            <li>โ ูพุดุชุจุงู ูุงุฏุงูโุงูุนูุฑ</li>
                            <li>โ ุชูุงู ุขูพุฏุชโูุง ุฑุงฺฏุงู</li>
                            <li>โ ุงูฺฉุงูุงุช ูฺู ู ุฌุฏุฏ</li>
                            <li>โ ุจุฏูู ุชุงุฑุฎ ุงููุถุง</li>
                        </ul>
                        <button onclick="purchaseUserSubscription('lifetime')" class="w-full bg-red-500 hover:bg-red-600 text-white py-3 rounded-lg font-medium transition-all">
                            ุงูุชุฎุงุจ ุงู ูพูุงู
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Contact Support Section -->
            <div class="bg-gradient-to-r from-blue-100 to-purple-100 border border-blue-200 rounded-lg p-6">
                <div class="text-center">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center justify-center">
                        <span class="text-2xl ml-2">๐ง</span>
                        ูุญูู ุฎุฑุฏ ุงุดุชุฑุงฺฉ
                    </h3>
                    <p class="text-gray-700 mb-4">ูพุณ ุงุฒ ุงูุชุฎุงุจ ูพูุงูุ ุจุง ุชู ูพุดุชุจุงู ูุง ุชูุงุณ ุจฺฏุฑุฏ:</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                        <button onclick="contactSupportForPurchase('phone')" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-3 rounded-lg transition-all flex items-center justify-center">
                            ๐ ฐนนณถตถตตฑฐถ
                        </button>
                        <button onclick="contactSupportForPurchase('telegram')" class="bg-blue-400 hover:bg-blue-500 text-white px-4 py-3 rounded-lg transition-all flex items-center justify-center">
                            ๐ฑ @Spaincar7
                        </button>
                        <button onclick="contactSupportForPurchase('whatsapp')" class="bg-green-500 hover:bg-green-600 text-white px-4 py-3 rounded-lg transition-all flex items-center justify-center">
                            ๐ฌ ฐนฑนนทถดฑตท
                        </button>
                        <button onclick="contactSupportForPurchase('eitaa')" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-3 rounded-lg transition-all flex items-center justify-center">
                            ๐ต @Spaincar77
                        </button>
                    </div>
                    
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                        <div class="flex items-center justify-center mb-2">
                            <span class="text-2xl ml-2">โก</span>
                            <h4 class="font-bold text-yellow-800">ูุฑุงุญู ุฎุฑุฏ:</h4>
                        </div>
                        <ul class="text-yellow-700 text-sm space-y-1">
                            <li>ฑ. ูพูุงู ููุฑุฏ ูุธุฑ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</li>
                            <li>ฒ. ุจุง ูพุดุชุจุงู ุชูุงุณ ุจฺฏุฑุฏ</li>
                            <li>ณ. ูุจูุบ ุฑุง ูพุฑุฏุงุฎุช ฺฉูุฏ</li>
                            <li>ด. ุงุดุชุฑุงฺฉ ููุฑุงู ูุนุงู ูโุดูุฏ</li>
                        </ul>
                        
                        <div class="mt-4 text-sm text-gray-600">
                            <p>โฐ ูพุดุชุจุงู: ุดูุจู ุชุง ูพูุฌโุดูุจู น ุชุง ฒฑ</p>
                            <p>๐ณ ูพุฑุฏุงุฎุช: ฺฉุงุฑุช ุจู ฺฉุงุฑุชุ ุฏุฑฺฏุงู ุจุงูฺฉ</p>
                            <p>โก ูุนุงูโุณุงุฒ: ููุฑ ูพุณ ุงุฒ ูพุฑุฏุงุฎุช</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                <!-- 1 Month Plan -->
                <div class="border-2 border-blue-200 rounded-xl p-6 hover:shadow-lg transition-all duration-200 bg-gradient-to-b from-blue-50 to-blue-100">
                    <div class="text-center">
                        <div class="text-4xl mb-3">๐</div>
                        <h3 class="text-xl font-bold text-blue-800 mb-2">ฺฉ ูุงูู</h3>
                        <div class="text-3xl font-bold text-blue-600 mb-4">นน ุชููุงู</div>
                        <ul class="text-sm text-blue-700 space-y-2 mb-6">
                            <li>โ ุชูุงู ุงูฺฉุงูุงุช</li>
                            <li>โ ูุงูุญุฏูุฏ ุชุฑุงฺฉูุด</li>
                            <li>โ ฺฏุฒุงุฑุดโฺฏุฑ PDF</li>
                            <li>โ ูพุดุชุจุงู ุขููุงู</li>
                        </ul>
                        <button onclick="purchaseSubscription('1month')" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-lg font-medium transition-all">
                            ุฎุฑุฏ ุงุดุชุฑุงฺฉ
                        </button>
                    </div>
                </div>
                
                <!-- 3 Month Plan -->
                <div class="border-2 border-green-200 rounded-xl p-6 hover:shadow-lg transition-all duration-200 bg-gradient-to-b from-green-50 to-green-100">
                    <div class="text-center">
                        <div class="text-4xl mb-3">๐</div>
                        <h3 class="text-xl font-bold text-green-800 mb-2">ุณู ูุงูู</h3>
                        <div class="text-3xl font-bold text-green-600 mb-2">ฑนน ุชููุงู</div>
                        <div class="text-sm text-green-500 mb-4">ุตุฑููโุฌู นธ ุชููุงู</div>
                        <ul class="text-sm text-green-700 space-y-2 mb-6">
                            <li>โ ุชูุงู ุงูฺฉุงูุงุช</li>
                            <li>โ ูุงูุญุฏูุฏ ุชุฑุงฺฉูุด</li>
                            <li>โ ฺฏุฒุงุฑุดโฺฏุฑ PDF</li>
                            <li>โ ูพุดุชุจุงู ุงูููุชโุฏุงุฑ</li>
                        </ul>
                        <button onclick="purchaseSubscription('3month')" class="w-full bg-green-500 hover:bg-green-600 text-white py-3 rounded-lg font-medium transition-all">
                            ุฎุฑุฏ ุงุดุชุฑุงฺฉ
                        </button>
                    </div>
                </div>
                
                <!-- 6 Month Plan -->
                <div class="border-2 border-purple-200 rounded-xl p-6 hover:shadow-lg transition-all duration-200 bg-gradient-to-b from-purple-50 to-purple-100">
                    <div class="text-center">
                        <div class="text-4xl mb-3">๐</div>
                        <h3 class="text-xl font-bold text-purple-800 mb-2">ุดุด ูุงูู</h3>
                        <div class="text-3xl font-bold text-purple-600 mb-2">ณนน ุชููุงู</div>
                        <div class="text-sm text-purple-500 mb-4">ุตุฑููโุฌู ฑนต ุชููุงู</div>
                        <ul class="text-sm text-purple-700 space-y-2 mb-6">
                            <li>โ ุชูุงู ุงูฺฉุงูุงุช</li>
                            <li>โ ูุงูุญุฏูุฏ ุชุฑุงฺฉูุด</li>
                            <li>โ ฺฏุฒุงุฑุดโฺฏุฑ PDF</li>
                            <li>โ ูพุดุชุจุงู VIP</li>
                        </ul>
                        <button onclick="purchaseSubscription('6month')" class="w-full bg-purple-500 hover:bg-purple-600 text-white py-3 rounded-lg font-medium transition-all">
                            ุฎุฑุฏ ุงุดุชุฑุงฺฉ
                        </button>
                    </div>
                </div>
                
                <!-- 12 Month Plan -->
                <div class="border-2 border-yellow-200 rounded-xl p-6 hover:shadow-lg transition-all duration-200 bg-gradient-to-b from-yellow-50 to-yellow-100 relative">
                    <div class="absolute -top-3 left-1/2 transform -translate-x-1/2">
                        <span class="bg-yellow-500 text-white px-4 py-1 rounded-full text-sm font-bold">ูุญุจูุจ</span>
                    </div>
                    <div class="text-center">
                        <div class="text-4xl mb-3">๐</div>
                        <h3 class="text-xl font-bold text-yellow-800 mb-2">ฺฉ ุณุงูู</h3>
                        <div class="text-3xl font-bold text-yellow-600 mb-2">ตนน ุชููุงู</div>
                        <div class="text-sm text-yellow-500 mb-4">ุตุฑููโุฌู ตธน ุชููุงู</div>
                        <ul class="text-sm text-yellow-700 space-y-2 mb-6">
                            <li>โ ุชูุงู ุงูฺฉุงูุงุช</li>
                            <li>โ ูุงูุญุฏูุฏ ุชุฑุงฺฉูุด</li>
                            <li>โ ฺฏุฒุงุฑุดโฺฏุฑ PDF</li>
                            <li>โ ูพุดุชุจุงู ุงุฎุชุตุงุต</li>
                            <li>โ ุขูพุฏุชโูุง ุฑุงฺฏุงู</li>
                        </ul>
                        <button onclick="purchaseSubscription('12month')" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white py-3 rounded-lg font-medium transition-all">
                            ุฎุฑุฏ ุงุดุชุฑุงฺฉ
                        </button>
                    </div>
                </div>
                
                <!-- 5 Year Plan -->
                <div class="border-2 border-indigo-200 rounded-xl p-6 hover:shadow-lg transition-all duration-200 bg-gradient-to-b from-indigo-50 to-indigo-100">
                    <div class="text-center">
                        <div class="text-4xl mb-3">๐</div>
                        <h3 class="text-xl font-bold text-indigo-800 mb-2">ูพูุฌ ุณุงูู</h3>
                        <div class="text-3xl font-bold text-indigo-600 mb-2">ฑ,ตฐฐ ุชููุงู</div>
                        <div class="text-sm text-indigo-500 mb-4">ุตุฑููโุฌู ฒ,ดทต ุชููุงู</div>
                        <ul class="text-sm text-indigo-700 space-y-2 mb-6">
                            <li>โ ุชูุงู ุงูฺฉุงูุงุช</li>
                            <li>โ ูุงูุญุฏูุฏ ุชุฑุงฺฉูุด</li>
                            <li>โ ฺฏุฒุงุฑุดโฺฏุฑ PDF</li>
                            <li>โ ูพุดุชุจุงู ุงุฎุชุตุงุต</li>
                            <li>โ ุขูพุฏุชโูุง ุฑุงฺฏุงู</li>
                            <li>โ ุงูฺฉุงูุงุช ูฺู</li>
                        </ul>
                        <button onclick="purchaseSubscription('5year')" class="w-full bg-indigo-500 hover:bg-indigo-600 text-white py-3 rounded-lg font-medium transition-all">
                            ุฎุฑุฏ ุงุดุชุฑุงฺฉ
                        </button>
                    </div>
                </div>
                
                <!-- Lifetime Plan -->
                <div class="border-2 border-red-200 rounded-xl p-6 hover:shadow-lg transition-all duration-200 bg-gradient-to-b from-red-50 to-red-100 relative">
                    <div class="absolute -top-3 left-1/2 transform -translate-x-1/2">
                        <span class="bg-red-500 text-white px-4 py-1 rounded-full text-sm font-bold">ุจูุชุฑู ุงุฑุฒุด</span>
                    </div>
                    <div class="text-center">
                        <div class="text-4xl mb-3">โพ๏ธ</div>
                        <h3 class="text-xl font-bold text-red-800 mb-2">ูุงูุญุฏูุฏ</h3>
                        <div class="text-3xl font-bold text-red-600 mb-2">ณ,ฐฐฐ ุชููุงู</div>
                        <div class="text-sm text-red-500 mb-4">ฺฉุจุงุฑ ูพุฑุฏุงุฎุช - ูุงุฏุงูโุงูุนูุฑ</div>
                        <ul class="text-sm text-red-700 space-y-2 mb-6">
                            <li>โ ุชูุงู ุงูฺฉุงูุงุช</li>
                            <li>โ ูุงูุญุฏูุฏ ุชุฑุงฺฉูุด</li>
                            <li>โ ฺฏุฒุงุฑุดโฺฏุฑ PDF</li>
                            <li>โ ูพุดุชุจุงู ูุงุฏุงูโุงูุนูุฑ</li>
                            <li>โ ุชูุงู ุขูพุฏุชโูุง ุฑุงฺฏุงู</li>
                            <li>โ ุงูฺฉุงูุงุช ูฺู ู ุฌุฏุฏ</li>
                            <li>โ ุจุฏูู ุชุงุฑุฎ ุงููุถุง</li>
                        </ul>
                        <button onclick="purchaseSubscription('lifetime')" class="w-full bg-red-500 hover:bg-red-600 text-white py-3 rounded-lg font-medium transition-all">
                            ุฎุฑุฏ ุงุดุชุฑุงฺฉ
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="bg-gradient-to-r from-blue-100 to-purple-100 border border-blue-200 rounded-lg p-6">
                <div class="text-center">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center justify-center">
                        <span class="text-2xl ml-2">๐ง</span>
                        ูุญูู ุฎุฑุฏ ุงุดุชุฑุงฺฉ
                    </h3>
                    <p class="text-gray-700 mb-4">ุจุฑุง ุฎุฑุฏ ุงุดุชุฑุงฺฉุ ุจุง ุชู ูพุดุชุจุงู ูุง ุชูุงุณ ุจฺฏุฑุฏ:</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <button onclick="contactSupport('phone')" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-3 rounded-lg transition-all flex items-center justify-center">
                            ๐ ฐนนณถตถตตฑฐถ
                        </button>
                        <button onclick="contactSupport('telegram')" class="bg-blue-400 hover:bg-blue-500 text-white px-4 py-3 rounded-lg transition-all flex items-center justify-center">
                            ๐ฑ @Spaincar7
                        </button>
                        <button onclick="contactSupport('whatsapp')" class="bg-green-500 hover:bg-green-600 text-white px-4 py-3 rounded-lg transition-all flex items-center justify-center">
                            ๐ฌ ฐนฑนนทถดฑตท
                        </button>
                        <button onclick="contactSupport('eitaa')" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-3 rounded-lg transition-all flex items-center justify-center">
                            ๐ต @Spaincar77
                        </button>
                    </div>
                    
                    <div class="mt-4 text-sm text-gray-600">
                        <p>โฐ ูพุดุชุจุงู: ุดูุจู ุชุง ูพูุฌโุดูุจู น ุชุง ฒฑ</p>
                        <p>๐ณ ูพุฑุฏุงุฎุช: ฺฉุงุฑุช ุจู ฺฉุงุฑุชุ ุฏุฑฺฏุงู ุจุงูฺฉ</p>
                        <p>โก ูุนุงูโุณุงุฒ: ููุฑ ูพุณ ุงุฒ ูพุฑุฏุงุฎุช</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Person Report Modal -->
    <div id="personReportModal" class="modal">
        <div class="modal-content theme-bg-secondary theme-text-primary">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">๐ ฺฏุฒุงุฑุด ูุฑุฏ</h2>
                <button onclick="closeModal('personReportModal')" class="text-2xl hover:opacity-70">&times;</button>
            </div>
            
            <div id="personReportContent">
                <!-- Content will be populated by JavaScript -->
            </div>
            
            <div class="flex gap-3 mt-6 flex-wrap">
                <button onclick="downloadPersonPDF()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition-all">
                    ๐ ุฏุงูููุฏ PDF
                </button>
                <button onclick="sharePersonReport('telegram')" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-all">
                    ๐ฑ ุชูฺฏุฑุงู
                </button>
                <button onclick="sharePersonReport('whatsapp')" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-all">
                    ๐ฌ ูุงุชุณุงูพ
                </button>
                <button onclick="sharePersonReport('eitaa')" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg transition-all">
                    ๐ต ุงุชุง
                </button>
                <button onclick="sharePersonReport('sms')" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg transition-all">
                    ๐จ ูพุงูฺฉ
                </button>
            </div>
        </div>
    </div>
    </div>

    <script>
        // Global Variables
        let currentUser = null;
        let isAdmin = false;
        let users = [];
        let pendingRegistrations = [];
        let people = [];
        let transactions = [];
        let currentPersonReport = null;
        
        // Admin credentials
        const ADMIN_CREDENTIALS = {
            username: 'admin_accounting_2024',
            password: 'SecureAdmin@2024#'
        };
        
        // Initialize system when page loads
        function initializeSystem() {
            console.log('Initializing system...');
            
            // Load data from localStorage
            loadSystemData();
            
            // Check URL hash for admin panel or secret admin access
            if (window.location.hash === '#admin' || window.location.hash === '#secret_admin_2024') {
                const savedAdmin = localStorage.getItem('currentAdmin');
                if (savedAdmin === 'true') {
                    isAdmin = true;
                    showAdminDashboard();
                } else {
                    showAdminPanel();
                }
                return;
            }
            
            // Check if user is logged in
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    if (currentUser && currentUser.id) {
                        showMainApp();
                        return;
                    }
                } catch (e) {
                    console.error('Error parsing saved user:', e);
                    localStorage.removeItem('currentUser');
                }
            }
            
            // Default to login screen
            showAuthScreens();
        }
        
        // Load system data from localStorage
        function loadSystemData() {
            try {
                users = JSON.parse(localStorage.getItem('systemUsers') || '[]');
                pendingRegistrations = JSON.parse(localStorage.getItem('pendingRegistrations') || '[]');
                console.log('Loaded users:', users.length);
                console.log('Loaded pending registrations:', pendingRegistrations.length);
            } catch (e) {
                console.error('Error loading system data:', e);
                users = [];
                pendingRegistrations = [];
            }
        }
        
        // Screen Management Functions
        function hideAllScreens() {
            const screens = ['authScreens', 'adminPanel', 'mainApp'];
            screens.forEach(screenId => {
                const element = document.getElementById(screenId);
                if (element) {
                    element.classList.add('hidden');
                }
            });
        }
        
        function showAuthScreens() {
            console.log('Showing auth screens');
            hideAllScreens();
            const authScreens = document.getElementById('authScreens');
            if (authScreens) {
                authScreens.classList.remove('hidden');
                showLoginScreen();
            }
        }
        
        function showAdminPanel() {
            console.log('Showing admin panel');
            hideAllScreens();
            const adminPanel = document.getElementById('adminPanel');
            const adminLogin = document.getElementById('adminLoginScreen');
            const adminDashboard = document.getElementById('adminDashboard');
            
            if (adminPanel && adminLogin && adminDashboard) {
                adminPanel.classList.remove('hidden');
                adminLogin.classList.remove('hidden');
                adminDashboard.classList.add('hidden');
            }
        }
        
        function showAdminDashboard() {
            console.log('Showing admin dashboard');
            hideAllScreens();
            const adminPanel = document.getElementById('adminPanel');
            const adminLogin = document.getElementById('adminLoginScreen');
            const adminDashboard = document.getElementById('adminDashboard');
            
            if (adminPanel && adminLogin && adminDashboard) {
                adminPanel.classList.remove('hidden');
                adminLogin.classList.add('hidden');
                adminDashboard.classList.remove('hidden');
                refreshAdminData();
            }
        }
        
        function showMainApp() {
            console.log('Showing main app');
            hideAllScreens();
            const mainApp = document.getElementById('mainApp');
            if (mainApp) {
                mainApp.classList.remove('hidden');
                loadUserData();
            }
        }
        
        // Auth Screen Navigation
        function showLoginScreen() {
            const loginScreen = document.getElementById('loginScreen');
            const registerScreen = document.getElementById('registerScreen');
            const codeScreen = document.getElementById('codeActivationScreen');
            
            if (loginScreen) loginScreen.classList.remove('hidden');
            if (registerScreen) registerScreen.classList.add('hidden');
            if (codeScreen) codeScreen.classList.add('hidden');
        }
        
        function showRegisterScreen() {
            const loginScreen = document.getElementById('loginScreen');
            const registerScreen = document.getElementById('registerScreen');
            const codeScreen = document.getElementById('codeActivationScreen');
            
            if (loginScreen) loginScreen.classList.add('hidden');
            if (registerScreen) registerScreen.classList.remove('hidden');
            if (codeScreen) codeScreen.classList.add('hidden');
        }
        
        function showCodeActivationScreen() {
            const loginScreen = document.getElementById('loginScreen');
            const registerScreen = document.getElementById('registerScreen');
            const codeScreen = document.getElementById('codeActivationScreen');
            
            if (loginScreen) loginScreen.classList.add('hidden');
            if (registerScreen) registerScreen.classList.add('hidden');
            if (codeScreen) codeScreen.classList.remove('hidden');
        }
        
        function backToUserLogin() {
            window.location.hash = '';
            isAdmin = false;
            localStorage.removeItem('currentAdmin');
            showAuthScreens();
        }
        
        function goToAdminPanel() {
            window.location.hash = '#admin';
            showAdminPanel();
        }
        
        // Utility Functions
        function generate12DigitCode() {
            return Math.floor(100000000000 + Math.random() * 900000000000).toString();
        }
        
        function saveSystemData() {
            try {
                localStorage.setItem('systemUsers', JSON.stringify(users));
                localStorage.setItem('pendingRegistrations', JSON.stringify(pendingRegistrations));
                console.log('System data saved successfully');
            } catch (e) {
                console.error('Error saving system data:', e);
            }
        }
        
        // Event Listeners Setup
        function setupEventListeners() {
            // Registration Form
            const registerForm = document.getElementById('registerForm');
            if (registerForm) {
                registerForm.addEventListener('submit', handleRegistration);
            }
            
            // Code Activation Form
            const codeForm = document.getElementById('codeActivationForm');
            if (codeForm) {
                codeForm.addEventListener('submit', handleCodeActivation);
            }
            
            // Login Form
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', handleUserLogin);
            }
            
            // Admin Login Form
            const adminLoginForm = document.getElementById('adminLoginForm');
            if (adminLoginForm) {
                adminLoginForm.addEventListener('submit', handleAdminLogin);
            }
        }
        
        // Registration Handler
        function handleRegistration(e) {
            e.preventDefault();
            console.log('Handling registration...');
            
            const name = document.getElementById('registerName').value.trim();
            const phone = document.getElementById('registerPhone').value.trim();
            const email = document.getElementById('registerEmail').value.trim();
            
            // Validation
            if (!name) {
                alert('ูุทูุงู ูุงู ู ูุงู ุฎุงููุงุฏฺฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ');
                return;
            }
            
            if (!phone || !/^09\d{9}$/.test(phone)) {
                alert('ุดูุงุฑู ุชููู ุจุงุฏ ุจุง 09 ุดุฑูุน ุดุฏู ู 11 ุฑูู ุจุงุดุฏ');
                return;
            }
            
            // Check for duplicate phone
            const existingPending = pendingRegistrations.find(r => r.phone === phone);
            const existingUser = users.find(u => u.phone === phone);
            
            if (existingPending || existingUser) {
                alert('ุงู ุดูุงุฑู ุชููู ูุจูุงู ุซุจุช ุดุฏู ุงุณุช');
                return;
            }
            
            // Create registration
            const registration = {
                id: Date.now(),
                name: name,
                phone: phone,
                email: email || '',
                registrationDate: new Date().toLocaleDateString('fa-IR'),
                status: 'pending',
                code: generate12DigitCode()
            };
            
            // Save registration
            pendingRegistrations.push(registration);
            saveSystemData();
            
            // Show success message
            alert(`โ ุฏุฑุฎูุงุณุช ุซุจุช ูุงู ุดูุง ุจุง ููููุช ุงุฑุณุงู ุดุฏ!

๐ ุงุทูุงุนุงุช ุดูุง:
๐ค ูุงู: ${name}
๐ฑ ุชููู: ${phone}
๐ ฺฉุฏ ุดูุง: ${registration.code}

โณ ูุทูุงู ููุชุธุฑ ุชุงุฏ ูุฏุฑ ุจุงุดุฏ.
ูพุณ ุงุฒ ุชุงุฏุ ูโุชูุงูุฏ ุจุง ฺฉุฏ ุจุงูุง ูุงุฑุฏ ุดูุฏ.`);
            
            // Reset form and go to login
            document.getElementById('registerForm').reset();
            showLoginScreen();
        }
        
        // Code Activation Handler
        function handleCodeActivation(e) {
            e.preventDefault();
            console.log('Handling code activation...');
            
            const code = document.getElementById('activationCode').value.trim();
            const password = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            // Validation
            if (!code || code.length !== 12) {
                alert('ฺฉุฏ ุจุงุฏ 12 ุฑูู ุจุงุดุฏ');
                return;
            }
            
            if (!password || password.length < 6) {
                alert('ุฑูุฒ ุนุจูุฑ ุจุงุฏ ุญุฏุงูู 6 ฺฉุงุฑุงฺฉุชุฑ ุจุงุดุฏ');
                return;
            }
            
            if (password !== confirmPassword) {
                alert('ุฑูุฒ ุนุจูุฑ ู ุชฺฉุฑุงุฑ ุขู ฺฉุณุงู ูุณุชูุฏ');
                return;
            }
            
            // Find user with this code
            const user = users.find(u => u.code === code && u.status === 'approved' && !u.password);
            
            if (!user) {
                alert('ฺฉุฏ ูุงุฑุฏ ุดุฏู ูุนุชุจุฑ ูุณุช ุง ูุจูุงู ูุนุงู ุดุฏู ุงุณุช');
                return;
            }
            
            // Activate user
            user.password = password;
            user.status = 'active';
            user.activationDate = new Date().toLocaleDateString('fa-IR');
            
            saveSystemData();
            
            alert('โ ุญุณุงุจ ุดูุง ุจุง ููููุช ูุนุงู ุดุฏ! ุงฺฉููู ูโุชูุงูุฏ ูุงุฑุฏ ุดูุฏ.');
            
            // Reset form and show login
            document.getElementById('codeActivationForm').reset();
            showLoginScreen();
        }
        
        // User Login Handler
        function handleUserLogin(e) {
            e.preventDefault();
            console.log('Handling user login...');
            
            const code = document.getElementById('loginCode').value.trim();
            const password = document.getElementById('loginPassword').value;
            
            if (!code || !password) {
                alert('ูุทูุงู ฺฉุฏ ู ุฑูุฒ ุนุจูุฑ ุฑุง ูุงุฑุฏ ฺฉูุฏ');
                return;
            }
            
            const user = users.find(u => u.code === code && u.password === password);
            
            if (!user) {
                alert('ฺฉุฏ ุง ุฑูุฒ ุนุจูุฑ ุงุดุชุจุงู ุงุณุช');
                return;
            }
            
            if (user.status === 'suspended') {
                alert('ุญุณุงุจ ุดูุง ูููุชุงู ูุณุฏูุฏ ุดุฏู ุงุณุช. ูุทูุงู ุจุง ูุฏุฑ ุชูุงุณ ุจฺฏุฑุฏ.');
                return;
            }
            
            if (user.status !== 'active') {
                alert('ุญุณุงุจ ุดูุง ูููุฒ ูุนุงู ูุดุฏู ุงุณุช');
                return;
            }
            
            // Login successful
            currentUser = user;
            user.lastLogin = new Date().toLocaleDateString('fa-IR');
            
            localStorage.setItem('currentUser', JSON.stringify(user));
            saveSystemData();
            
            console.log('User logged in successfully:', user.name);
            showMainApp();
        }
        
        // Admin Login Handler
        function handleAdminLogin(e) {
            e.preventDefault();
            console.log('Handling admin login...');
            
            const username = document.getElementById('adminUsername').value.trim();
            const password = document.getElementById('adminPassword').value;
            
            if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
                isAdmin = true;
                localStorage.setItem('currentAdmin', 'true');
                console.log('Admin logged in successfully');
                showAdminDashboard();
            } else {
                alert('ูุงู ฺฉุงุฑุจุฑ ุง ุฑูุฒ ุนุจูุฑ ูุฏุฑ ุงุดุชุจุงู ุงุณุช');
            }
        }
        
        // Logout Functions
        function userLogout() {
            if (confirm('ุขุง ูโุฎูุงูุฏ ุงุฒ ุญุณุงุจ ุฎูุฏ ุฎุงุฑุฌ ุดูุฏุ')) {
                currentUser = null;
                localStorage.removeItem('currentUser');
                showAuthScreens();
            }
        }
        
        function adminLogout() {
            if (confirm('ุขุง ูโุฎูุงูุฏ ุงุฒ ูพูู ูุฏุฑุช ุฎุงุฑุฌ ุดูุฏุ')) {
                isAdmin = false;
                localStorage.removeItem('currentAdmin');
                showAdminPanel();
            }
        }
        
        // Admin Functions
        function refreshAdminData() {
            console.log('Refreshing admin data...');
            loadSystemData();
            updateAdminStats();
            renderPendingRegistrations();
            renderUsersList();
            renderSubscriptionsList();
            updateSubscriptionUserSelect();
        }
        
        function updateAdminStats() {
            const totalUsersCount = users.length;
            const activeUsersCount = users.filter(u => u.status === 'active').length;
            const pendingUsersCount = pendingRegistrations.length;
            const blockedUsersCount = users.filter(u => u.status === 'suspended').length;
            
            const totalUsersEl = document.getElementById('totalUsers');
            const activeUsersEl = document.getElementById('activeUsers');
            const pendingUsersEl = document.getElementById('pendingUsers');
            const blockedUsersEl = document.getElementById('blockedUsers');
            
            if (totalUsersEl) totalUsersEl.textContent = totalUsersCount;
            if (activeUsersEl) activeUsersEl.textContent = activeUsersCount;
            if (pendingUsersEl) pendingUsersEl.textContent = pendingUsersCount;
            if (blockedUsersEl) blockedUsersEl.textContent = blockedUsersCount;
        }
        
        function renderPendingRegistrations() {
            const container = document.getElementById('pendingRegistrations');
            if (!container) return;
            
            if (pendingRegistrations.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <span class="text-6xl">๐</span>
                        <p class="mt-4 text-lg">ุฏุฑุฎูุงุณุช ุฌุฏุฏ ูุฌูุฏ ูุฏุงุฑุฏ</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = pendingRegistrations.map(registration => `
                <div class="border border-yellow-200 rounded-lg p-4 mb-4 bg-yellow-50">
                    <div class="flex justify-between items-center">
                        <div>
                            <h3 class="font-bold text-lg text-gray-800">${registration.name}</h3>
                            <p class="text-gray-600">๐ฑ ${registration.phone}</p>
                            <p class="text-gray-600">๐ง ${registration.email || 'ูุฏุงุฑุฏ'}</p>
                            <p class="text-gray-500 text-sm">๐ ${registration.registrationDate}</p>
                            <p class="text-blue-600 font-mono text-sm">๐ ฺฉุฏ: ${registration.code}</p>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="approveRegistration(${registration.id})" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-all">
                                โ ุชุงุฏ
                            </button>
                            <button onclick="rejectRegistration(${registration.id})" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition-all">
                                โ ุฑุฏ
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        function renderUsersList() {
            const container = document.getElementById('usersList');
            if (!container) return;
            
            if (users.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <span class="text-6xl">๐ค</span>
                        <p class="mt-4 text-lg">ฺฉุงุฑุจุฑ ูุฌูุฏ ูุฏุงุฑุฏ</p>
                    </div>
                `;
                return;
            }
            
            const statusColors = {
                'active': 'bg-green-100 text-green-800',
                'approved': 'bg-blue-100 text-blue-800',
                'suspended': 'bg-red-100 text-red-800'
            };
            
            const statusTexts = {
                'active': 'ูุนุงู',
                'approved': 'ุชุงุฏ ุดุฏู',
                'suspended': 'ูุณุฏูุฏ'
            };
            
            container.innerHTML = users.map(user => `
                <div class="border border-gray-200 rounded-lg p-4 mb-4">
                    <div class="flex justify-between items-center">
                        <div>
                            <h3 class="font-bold text-lg text-gray-800">${user.name}</h3>
                            <p class="text-gray-600">๐ฑ ${user.phone}</p>
                            <p class="text-gray-600">๐ง ${user.email || 'ูุฏุงุฑุฏ'}</p>
                            <p class="text-gray-500 text-sm">๐ ุซุจุช ูุงู: ${user.registrationDate}</p>
                            <p class="text-gray-500 text-sm">๐ ฺฉุฏ: ${user.code}</p>
                            ${user.lastLogin ? `<p class="text-gray-500 text-sm">๐ ุขุฎุฑู ูุฑูุฏ: ${user.lastLogin}</p>` : ''}
                            <span class="inline-block px-2 py-1 rounded-full text-xs font-medium ${statusColors[user.status] || 'bg-gray-100 text-gray-800'}">
                                ${statusTexts[user.status] || user.status}
                            </span>
                        </div>
                        <div class="flex gap-2 flex-col">
                            ${user.status === 'active' ? 
                                `<button onclick="suspendUser(${user.id})" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm transition-all">
                                    ๐ซ ูุณุฏูุฏ
                                </button>` :
                                user.status === 'suspended' ?
                                `<button onclick="activateUser(${user.id})" class="bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded text-sm transition-all">
                                    โ ูุนุงู
                                </button>` : ''
                            }
                            <button onclick="deleteUser(${user.id})" class="bg-gray-500 hover:bg-gray-600 text-white px-3 py-1 rounded text-sm transition-all">
                                ๐๏ธ ุญุฐู
                            </button>
                            <button onclick="resetUserPassword(${user.id})" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm transition-all">
                                ๐ ุฑุณุช ุฑูุฒ
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        // Admin Action Functions
        function approveRegistration(id) {
            console.log('Approving registration:', id);
            const registration = pendingRegistrations.find(r => r.id === id);
            if (!registration) {
                alert('ุฏุฑุฎูุงุณุช ุงูุช ูุดุฏ');
                return;
            }
            
            const user = {
                id: Date.now(),
                name: registration.name,
                phone: registration.phone,
                email: registration.email,
                code: registration.code,
                registrationDate: registration.registrationDate,
                approvalDate: new Date().toLocaleDateString('fa-IR'),
                status: 'approved',
                password: null,
                lastLogin: null
            };
            
            users.push(user);
            pendingRegistrations = pendingRegistrations.filter(r => r.id !== id);
            saveSystemData();
            
            alert(`โ ฺฉุงุฑุจุฑ ${registration.name} ุชุงุฏ ุดุฏ!

๐ ฺฉุฏ ูุนุงูโุณุงุฒ: ${registration.code}

ุงู ฺฉุฏ ุฑุง ุจู ฺฉุงุฑุจุฑ ุงุฑุณุงู ฺฉูุฏ ุชุง ุจุชูุงูุฏ ุญุณุงุจ ุฎูุฏ ุฑุง ูุนุงู ฺฉูุฏ.`);
            
            refreshAdminData();
        }
        
        function rejectRegistration(id) {
            if (confirm('ุขุง ุงุฒ ุฑุฏ ุงู ุฏุฑุฎูุงุณุช ุงุทููุงู ุฏุงุฑุฏุ')) {
                pendingRegistrations = pendingRegistrations.filter(r => r.id !== id);
                saveSystemData();
                refreshAdminData();
            }
        }
        
        function suspendUser(id) {
            if (confirm('ุขุง ูโุฎูุงูุฏ ุงู ฺฉุงุฑุจุฑ ุฑุง ูุณุฏูุฏ ฺฉูุฏุ')) {
                const user = users.find(u => u.id === id);
                if (user) {
                    user.status = 'suspended';
                    saveSystemData();
                    refreshAdminData();
                }
            }
        }
        
        function activateUser(id) {
            const user = users.find(u => u.id === id);
            if (user) {
                user.status = 'active';
                saveSystemData();
                refreshAdminData();
            }
        }
        
        function deleteUser(id) {
            if (confirm('ุขุง ุงุฒ ุญุฐู ุงู ฺฉุงุฑุจุฑ ุงุทููุงู ุฏุงุฑุฏุ ุชูุงู ุฏุงุฏูโูุง ุงู ุญุฐู ุฎูุงูุฏ ุดุฏ.')) {
                const user = users.find(u => u.id === id);
                if (user) {
                    localStorage.removeItem(`userData_${user.id}`);
                    users = users.filter(u => u.id !== id);
                    saveSystemData();
                    refreshAdminData();
                }
            }
        }
        
        function resetUserPassword(id) {
            const user = users.find(u => u.id === id);
            if (user) {
                user.password = null;
                user.status = 'approved';
                saveSystemData();
                
                alert(`๐ ุฑูุฒ ุนุจูุฑ ฺฉุงุฑุจุฑ ${user.name} ุฑุณุช ุดุฏ.

๐ ฺฉุฏ ูุนุงูโุณุงุฒ: ${user.code}

ฺฉุงุฑุจุฑ ุจุงุฏ ูุฌุฏุฏุงู ุฑูุฒ ุนุจูุฑ ุชูุธู ฺฉูุฏ.`);
                
                refreshAdminData();
            }
        }
        
        // Update subscription user select
        function updateSubscriptionUserSelect() {
            const select = document.getElementById('subscriptionUserId');
            if (!select) return;
            
            select.innerHTML = '<option value="">ฺฉุงุฑุจุฑ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</option>' +
                users.filter(u => u.status === 'active').map(user => 
                    `<option value="${user.id}">${user.name} (${user.phone})</option>`
                ).join('');
        }
        
        // Activate user subscription
        function activateUserSubscription() {
            const userId = document.getElementById('subscriptionUserId').value;
            const subscriptionType = document.getElementById('subscriptionType').value;
            
            if (!userId || !subscriptionType) {
                alert('ูุทูุงู ฺฉุงุฑุจุฑ ู ููุน ุงุดุชุฑุงฺฉ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ');
                return;
            }
            
            const user = users.find(u => u.id == userId);
            if (!user) {
                alert('ฺฉุงุฑุจุฑ ุงูุช ูุดุฏ');
                return;
            }
            
            const plans = {
                '1month': { name: 'ฺฉ ูุงูู', duration: 30, price: 'นน ุชููุงู' },
                '3month': { name: 'ุณู ูุงูู', duration: 90, price: 'ฑนน ุชููุงู' },
                '6month': { name: 'ุดุด ูุงูู', duration: 180, price: 'ณนน ุชููุงู' },
                '12month': { name: 'ฺฉ ุณุงูู', duration: 365, price: 'ตนน ุชููุงู' },
                '5year': { name: 'ูพูุฌ ุณุงูู', duration: 1825, price: 'ฑ,ตฐฐ ุชููุงู' },
                'lifetime': { name: 'ูุงูุญุฏูุฏ', duration: 36500, price: 'ณ,ฐฐฐ ุชููุงู' }
            };
            
            const selectedPlan = plans[subscriptionType];
            const now = new Date().getTime();
            
            // Create subscription data for user
            const userSubKey = `subscription_${userId}`;
            const subscriptionData = {
                installDate: now,
                subscriptionType: subscriptionType,
                expiryDate: subscriptionType === 'lifetime' ? 
                    now + (36500 * 24 * 60 * 60 * 1000) : 
                    now + (selectedPlan.duration * 24 * 60 * 60 * 1000),
                isActive: true,
                userId: parseInt(userId),
                activatedBy: 'admin',
                activationDate: new Date().toLocaleDateString('fa-IR')
            };
            
            localStorage.setItem(userSubKey, JSON.stringify(subscriptionData));
            
            alert(`โ ุงุดุชุฑุงฺฉ ${selectedPlan.name} ุจุฑุง ฺฉุงุฑุจุฑ ${user.name} ูุนุงู ุดุฏ!

๐ฐ ููุช: ${selectedPlan.price}
โฐ ูุฏุช: ${selectedPlan.name}
๐ ุชุงุฑุฎ ูุนุงูโุณุงุฒ: ${subscriptionData.activationDate}`);
            
            // Reset form
            document.getElementById('subscriptionUserId').value = '';
            document.getElementById('subscriptionType').value = '';
            
            refreshAdminData();
        }
        
        // Render subscriptions list
        function renderSubscriptionsList() {
            const container = document.getElementById('subscriptionsList');
            if (!container) return;
            
            const activeSubscriptions = [];
            
            // Get all active subscriptions
            users.forEach(user => {
                const userSubKey = `subscription_${user.id}`;
                const subData = JSON.parse(localStorage.getItem(userSubKey) || '{}');
                
                if (subData.isActive && subData.subscriptionType !== 'trial') {
                    activeSubscriptions.push({
                        user: user,
                        subscription: subData
                    });
                }
            });
            
            if (activeSubscriptions.length === 0) {
                container.innerHTML = `
                    <h3 class="text-lg font-semibold text-gray-700 mb-4">ูุณุช ุงุดุชุฑุงฺฉโูุง ูุนุงู</h3>
                    <div class="text-center text-gray-500 py-8">
                        <span class="text-6xl">๐</span>
                        <p class="mt-4 text-lg">ุงุดุชุฑุงฺฉ ูุนุงู ูุฌูุฏ ูุฏุงุฑุฏ</p>
                    </div>
                `;
                return;
            }
            
            const plans = {
                '1month': { name: 'ฺฉ ูุงูู', price: 'นน ุชููุงู' },
                '3month': { name: 'ุณู ูุงูู', price: 'ฑนน ุชููุงู' },
                '6month': { name: 'ุดุด ูุงูู', price: 'ณนน ุชููุงู' },
                '12month': { name: 'ฺฉ ุณุงูู', price: 'ตนน ุชููุงู' },
                '5year': { name: 'ูพูุฌ ุณุงูู', price: 'ฑ,ตฐฐ ุชููุงู' },
                'lifetime': { name: 'ูุงูุญุฏูุฏ', price: 'ณ,ฐฐฐ ุชููุงู' }
            };
            
            container.innerHTML = `
                <h3 class="text-lg font-semibold text-gray-700 mb-4">ูุณุช ุงุดุชุฑุงฺฉโูุง ูุนุงู (${activeSubscriptions.length} ููุฑุฏ)</h3>
                <div class="space-y-4">
                    ${activeSubscriptions.map(item => {
                        const plan = plans[item.subscription.subscriptionType];
                        const expiryDate = new Date(item.subscription.expiryDate).toLocaleDateString('fa-IR');
                        const remainingDays = Math.max(0, Math.ceil((item.subscription.expiryDate - new Date().getTime()) / (24 * 60 * 60 * 1000)));
                        
                        return `
                            <div class="border border-green-200 rounded-lg p-4 bg-green-50">
                                <div class="flex justify-between items-center">
                                    <div>
                                        <h4 class="font-bold text-lg text-gray-800">${item.user.name}</h4>
                                        <p class="text-gray-600">๐ฑ ${item.user.phone}</p>
                                        <p class="text-green-600 font-medium">๐ ${plan.name} (${plan.price})</p>
                                        <p class="text-gray-500 text-sm">๐ ูุนุงูโุณุงุฒ: ${item.subscription.activationDate}</p>
                                        ${item.subscription.subscriptionType !== 'lifetime' ? 
                                            `<p class="text-gray-500 text-sm">โฐ ุงููุถุง: ${expiryDate} (${remainingDays} ุฑูุฒ ุจุงูโูุงูุฏู)</p>` :
                                            `<p class="text-green-600 text-sm">โพ๏ธ ูุงูุญุฏูุฏ - ุจุฏูู ุงููุถุง</p>`
                                        }
                                    </div>
                                    <div class="flex gap-2">
                                        <button onclick="extendUserSubscription(${item.user.id})" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm transition-all">
                                            โฐ ุชูุฏุฏ
                                        </button>
                                        <button onclick="cancelUserSubscription(${item.user.id})" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm transition-all">
                                            โ ูุบู
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }
        
        // Extend user subscription
        function extendUserSubscription(userId) {
            const user = users.find(u => u.id == userId);
            if (!user) return;
            
            const userSubKey = `subscription_${userId}`;
            const subData = JSON.parse(localStorage.getItem(userSubKey) || '{}');
            
            if (!subData.isActive) {
                alert('ุงุดุชุฑุงฺฉ ุงู ฺฉุงุฑุจุฑ ูุนุงู ูุณุช');
                return;
            }
            
            const extensionDays = prompt('ฺูุฏ ุฑูุฒ ุจู ุงุดุชุฑุงฺฉ ุงุถุงูู ุดูุฏุ', '30');
            if (!extensionDays || isNaN(extensionDays) || extensionDays <= 0) {
                return;
            }
            
            const additionalTime = parseInt(extensionDays) * 24 * 60 * 60 * 1000;
            subData.expiryDate += additionalTime;
            
            localStorage.setItem(userSubKey, JSON.stringify(subData));
            
            alert(`โ ุงุดุชุฑุงฺฉ ฺฉุงุฑุจุฑ ${user.name} ุจู ูุฏุช ${extensionDays} ุฑูุฒ ุชูุฏุฏ ุดุฏ!`);
            
            refreshAdminData();
        }
        
        // Cancel user subscription
        function cancelUserSubscription(userId) {
            const user = users.find(u => u.id == userId);
            if (!user) return;
            
            if (confirm(`ุขุง ุงุฒ ูุบู ุงุดุชุฑุงฺฉ ฺฉุงุฑุจุฑ ${user.name} ุงุทููุงู ุฏุงุฑุฏุ`)) {
                const userSubKey = `subscription_${userId}`;
                const subData = JSON.parse(localStorage.getItem(userSubKey) || '{}');
                
                subData.isActive = false;
                subData.cancelDate = new Date().toLocaleDateString('fa-IR');
                subData.canceledBy = 'admin';
                
                localStorage.setItem(userSubKey, JSON.stringify(subData));
                
                alert(`โ ุงุดุชุฑุงฺฉ ฺฉุงุฑุจุฑ ${user.name} ูุบู ุดุฏ`);
                
                refreshAdminData();
            }
        }
        
        // User Data Functions
        function loadUserData() {
            if (!currentUser) return;
            
            try {
                const userDataKey = `userData_${currentUser.id}`;
                const userData = JSON.parse(localStorage.getItem(userDataKey) || '{}');
                
                people = userData.people || [];
                transactions = userData.transactions || [];
                
                setTimeout(() => {
                    if (typeof renderPeople === 'function') renderPeople();
                    if (typeof renderTransactions === 'function') renderTransactions();
                    if (typeof updateTransactionSelect === 'function') updateTransactionSelect();
                    if (typeof updateSummary === 'function') updateSummary();
                    if (typeof updateCharts === 'function') updateCharts();
                    if (typeof renderIndividualTables === 'function') renderIndividualTables();
                    if (typeof updateTrialStatus === 'function') updateTrialStatus();
                }, 100);
            } catch (error) {
                console.error('Error loading user data:', error);
                people = [];
                transactions = [];
            }
        }
        
        function saveUserData() {
            if (!currentUser) return;
            
            const userDataKey = `userData_${currentUser.id}`;
            const userData = {
                people: people,
                transactions: transactions
            };
            
            localStorage.setItem(userDataKey, JSON.stringify(userData));
        }
        
        // Override saveData to use user-specific storage
        function saveData() {
            saveUserData();
            updateSummary();
            updateCharts();
            renderIndividualTables();
        }

        // Subscription Management
        const TRIAL_DAYS = 7;
        
        // Get user-specific subscription data
        function getUserSubscriptionData() {
            if (!currentUser) return null;
            const userSubKey = `subscription_${currentUser.id}`;
            let subscriptionData = JSON.parse(localStorage.getItem(userSubKey) || '{}');
            
            // Initialize subscription data if not exists for this user
            if (!subscriptionData.installDate) {
                subscriptionData = {
                    installDate: new Date().getTime(),
                    subscriptionType: 'trial',
                    expiryDate: new Date().getTime() + (TRIAL_DAYS * 24 * 60 * 60 * 1000),
                    isActive: true,
                    userId: currentUser.id
                };
                localStorage.setItem(userSubKey, JSON.stringify(subscriptionData));
            }
            
            return subscriptionData;
        }
        
        // Save user subscription data
        function saveUserSubscriptionData(data) {
            if (!currentUser) return;
            const userSubKey = `subscription_${currentUser.id}`;
            localStorage.setItem(userSubKey, JSON.stringify(data));
        }

        // Check subscription status
        function checkSubscriptionStatus() {
            const subscriptionData = getUserSubscriptionData();
            if (!subscriptionData) return false;
            
            const now = new Date().getTime();
            const isExpired = now > subscriptionData.expiryDate;
            
            if (isExpired && subscriptionData.subscriptionType === 'trial') {
                subscriptionData.isActive = false;
                saveUserSubscriptionData(subscriptionData);
                showSubscriptionModal();
                return false;
            }
            
            return subscriptionData.isActive;
        }

        // Get remaining trial days
        function getRemainingTrialDays() {
            const subscriptionData = getUserSubscriptionData();
            if (!subscriptionData) return 0;
            
            const now = new Date().getTime();
            const remaining = Math.max(0, Math.ceil((subscriptionData.expiryDate - now) / (24 * 60 * 60 * 1000)));
            return remaining;
        }

        // Show subscription modal
        function showSubscriptionModal() {
            showModal('subscriptionModal');
        }

        // Show user subscription modal
        function showUserSubscriptionModal() {
            updateCurrentSubscriptionStatus();
            showModal('userSubscriptionModal');
        }

        // Update current subscription status
        function updateCurrentSubscriptionStatus() {
            const statusElement = document.getElementById('currentSubscriptionStatus');
            if (!statusElement) return;
            
            const subscriptionData = getUserSubscriptionData();
            if (!subscriptionData) return;
            
            const remainingDays = getRemainingTrialDays();
            
            if (subscriptionData.subscriptionType === 'trial') {
                if (remainingDays > 0) {
                    statusElement.innerHTML = `
                        <div class="flex items-center justify-center mb-2">
                            <span class="text-3xl ml-2">โฐ</span>
                            <h3 class="text-xl font-bold text-blue-800">ุฏูุฑู ุขุฒูุงุด ูุนุงู</h3>
                        </div>
                        <p class="text-blue-700">ุดูุง ${remainingDays} ุฑูุฒ ุงุฒ ุฏูุฑู ุขุฒูุงุด ุจุงูโูุงูุฏู ุฏุงุฑุฏ</p>
                        <p class="text-blue-600 text-sm mt-2">ุจุฑุง ุงุฏุงูู ุงุณุชูุงุฏู ูพุณ ุงุฒ ุงุชูุงู ุฏูุฑู ุขุฒูุงุดุ ฺฉ ุงุฒ ูพูุงูโูุง ุฒุฑ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</p>
                    `;
                    statusElement.className = 'bg-gradient-to-r from-blue-100 to-blue-200 border border-blue-300 rounded-lg p-4 mb-6';
                } else {
                    statusElement.innerHTML = `
                        <div class="flex items-center justify-center mb-2">
                            <span class="text-3xl ml-2">โฐ</span>
                            <h3 class="text-xl font-bold text-red-800">ุฏูุฑู ุขุฒูุงุด ุจู ูพุงุงู ุฑุณุฏ!</h3>
                        </div>
                        <p class="text-red-700">ุจุฑุง ุงุฏุงูู ุงุณุชูุงุฏู ุงุฒ ุชูุงู ุงูฺฉุงูุงุชุ ูุทูุงู ฺฉ ุงุฒ ูพูุงูโูุง ุฒุฑ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</p>
                    `;
                    statusElement.className = 'bg-gradient-to-r from-red-100 to-red-200 border border-red-300 rounded-lg p-4 mb-6';
                }
            } else {
                const plans = {
                    '1month': 'ฺฉ ูุงูู',
                    '3month': 'ุณู ูุงูู', 
                    '6month': 'ุดุด ูุงูู',
                    '12month': 'ฺฉ ุณุงูู',
                    '5year': 'ูพูุฌ ุณุงูู',
                    'lifetime': 'ูุงูุญุฏูุฏ'
                };
                
                const planName = plans[subscriptionData.subscriptionType] || 'ูุนุงู';
                const expiryDate = subscriptionData.subscriptionType === 'lifetime' ? 
                    'ุจุฏูู ุงููุถุง' : 
                    new Date(subscriptionData.expiryDate).toLocaleDateString('fa-IR');
                
                statusElement.innerHTML = `
                    <div class="flex items-center justify-center mb-2">
                        <span class="text-3xl ml-2">โ</span>
                        <h3 class="text-xl font-bold text-green-800">ุงุดุชุฑุงฺฉ ${planName} ูุนุงู</h3>
                    </div>
                    <p class="text-green-700">ุงุดุชุฑุงฺฉ ุดูุง ูุนุงู ุงุณุช ู ุงุฒ ุชูุงู ุงูฺฉุงูุงุช ูโุชูุงูุฏ ุงุณุชูุงุฏู ฺฉูุฏ</p>
                    <p class="text-green-600 text-sm mt-2">ุงููุถุง: ${expiryDate}</p>
                `;
                statusElement.className = 'bg-gradient-to-r from-green-100 to-green-200 border border-green-300 rounded-lg p-4 mb-6';
            }
        }

        // Purchase user subscription
        function purchaseUserSubscription(planType) {
            const plans = {
                '1month': { name: 'ฺฉ ูุงูู', price: 'นน ุชููุงู', duration: 30 },
                '3month': { name: 'ุณู ูุงูู', price: 'ฑนน ุชููุงู', duration: 90 },
                '6month': { name: 'ุดุด ูุงูู', price: 'ณนน ุชููุงู', duration: 180 },
                '12month': { name: 'ฺฉ ุณุงูู', price: 'ตนน ุชููุงู', duration: 365 },
                '5year': { name: 'ูพูุฌ ุณุงูู', price: 'ฑ,ตฐฐ ุชููุงู', duration: 1825 },
                'lifetime': { name: 'ูุงูุญุฏูุฏ', price: 'ณ,ฐฐฐ ุชููุงู', duration: 36500 }
            };
            
            const selectedPlan = plans[planType];
            const userInfo = currentUser ? `ูุงู: ${currentUser.name}\nุชููู: ${currentUser.phone}\nฺฉุฏ ฺฉุงุฑุจุฑ: ${currentUser.code}` : '';
            const message = `ุณูุงู! ูโุฎูุงูู ุงุดุชุฑุงฺฉ ${selectedPlan.name} ุจู ููุช ${selectedPlan.price} ุฑุง ุฎุฑุฏุงุฑ ฺฉูู.

ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ:
${userInfo}

ูุทูุงู ุฑุงูููุง ฺฉูุฏ.`;
            
            // Show purchase confirmation modal
            const purchaseModal = document.createElement('div');
            purchaseModal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            purchaseModal.innerHTML = `
                <div class="bg-white rounded-xl p-8 max-w-lg mx-4 text-center">
                    <div class="text-6xl mb-4">๐</div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-4">ุฎุฑุฏ ุงุดุชุฑุงฺฉ ${selectedPlan.name}</h3>
                    <div class="bg-gradient-to-r from-blue-100 to-purple-100 rounded-lg p-6 mb-6">
                        <div class="text-3xl font-bold text-blue-600 mb-2">${selectedPlan.price}</div>
                        <div class="text-gray-700">ูุฏุช ุงุดุชุฑุงฺฉ: ${selectedPlan.name}</div>
                        <div class="text-gray-600 text-sm mt-2">ฺฉุงุฑุจุฑ: ${currentUser ? currentUser.name : 'ูุงูุดุฎุต'}</div>
                    </div>
                    
                    <p class="text-gray-600 mb-6">ุจุฑุง ุฎุฑุฏ ุงู ุงุดุชุฑุงฺฉุ ุจุง ฺฉ ุงุฒ ุฑุงูโูุง ุฒุฑ ุชูุงุณ ุจฺฏุฑุฏ:</p>
                    
                    <div class="grid grid-cols-1 gap-3 mb-6">
                        <button onclick="contactSupportWithMessage('phone', '${message}'); this.parentElement.parentElement.parentElement.remove();" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-3 rounded-lg transition-all flex items-center justify-center">
                            ๐ ุชูุงุณ ุชููู: ฐนนณถตถตตฑฐถ
                        </button>
                        <button onclick="contactSupportWithMessage('telegram', '${message}'); this.parentElement.parentElement.parentElement.remove();" class="w-full bg-blue-400 hover:bg-blue-500 text-white px-4 py-3 rounded-lg transition-all flex items-center justify-center">
                            ๐ฑ ุชูฺฏุฑุงู: @Spaincar7
                        </button>
                        <button onclick="contactSupportWithMessage('whatsapp', '${message}'); this.parentElement.parentElement.parentElement.remove();" class="w-full bg-green-500 hover:bg-green-600 text-white px-4 py-3 rounded-lg transition-all flex items-center justify-center">
                            ๐ฌ ูุงุชุณุงูพ: ฐนฑนนทถดฑตท
                        </button>
                        <button onclick="contactSupportWithMessage('eitaa', '${message}'); this.parentElement.parentElement.parentElement.remove();" class="w-full bg-purple-500 hover:bg-purple-600 text-white px-4 py-3 rounded-lg transition-all flex items-center justify-center">
                            ๐ต ุงุชุง: @Spaincar77
                        </button>
                    </div>
                    
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4">
                        <div class="flex items-center justify-center mb-2">
                            <span class="text-2xl ml-2">โก</span>
                            <h4 class="font-bold text-yellow-800">ูุฑุขูุฏ ุฎุฑุฏ:</h4>
                        </div>
                        <ul class="text-yellow-700 text-sm space-y-1">
                            <li>ฑ. ุจุง ูพุดุชุจุงู ุชูุงุณ ุจฺฏุฑุฏ</li>
                            <li>ฒ. ูุจูุบ ุฑุง ูพุฑุฏุงุฎุช ฺฉูุฏ</li>
                            <li>ณ. ุงุดุชุฑุงฺฉ ููุฑุงู ูุนุงู ูโุดูุฏ</li>
                        </ul>
                    </div>
                    
                    <div class="flex gap-3">
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" class="w-full bg-gray-300 hover:bg-gray-400 text-gray-700 px-4 py-2 rounded-lg transition-all">
                            ุจุณุชู
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(purchaseModal);
        }



        // Contact support for purchase
        function contactSupportForPurchase(platform) {
            const subscriptionData = getUserSubscriptionData();
            const remainingDays = getRemainingTrialDays();
            const userInfo = currentUser ? `ูุงู: ${currentUser.name}\nุชููู: ${currentUser.phone}\nฺฉุฏ ฺฉุงุฑุจุฑ: ${currentUser.code}` : '';
            
            let message = `ุณูุงู! ูโุฎูุงูู ุงุดุชุฑุงฺฉ ุญุณุงุจุฏุงุฑ ุฎุฑุฏุงุฑ ฺฉูู.

ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ:
${userInfo}

ูุถุนุช ูุนู: `;
            
            if (subscriptionData.subscriptionType === 'trial') {
                if (remainingDays > 0) {
                    message += `ุฏูุฑู ุขุฒูุงุด (${remainingDays} ุฑูุฒ ุจุงูโูุงูุฏู)`;
                } else {
                    message += `ุฏูุฑู ุขุฒูุงุด ุจู ูพุงุงู ุฑุณุฏู`;
                }
            } else {
                const plans = {
                    '1month': 'ฺฉ ูุงูู',
                    '3month': 'ุณู ูุงูู', 
                    '6month': 'ุดุด ูุงูู',
                    '12month': 'ฺฉ ุณุงูู',
                    '5year': 'ูพูุฌ ุณุงูู',
                    'lifetime': 'ูุงูุญุฏูุฏ'
                };
                message += `ุงุดุชุฑุงฺฉ ${plans[subscriptionData.subscriptionType]} ูุนุงู`;
            }
            
            message += `\n\nูุทูุงู ุฑุงูููุง ฺฉูุฏ.`;
            
            contactSupportWithMessage(platform, message);
        }

        // Block transaction features
        function blockTransactionFeatures() {
            const transactionForm = document.getElementById('transactionForm');
            const personForm = document.getElementById('personForm');
            
            if (transactionForm) {
                transactionForm.style.opacity = '0.5';
                transactionForm.style.pointerEvents = 'none';
            }
            
            if (personForm) {
                personForm.style.opacity = '0.5';
                personForm.style.pointerEvents = 'none';
            }
            
            // Add overlay message
            const overlay = document.createElement('div');
            overlay.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            overlay.innerHTML = `
                <div class="bg-white rounded-xl p-8 max-w-md mx-4 text-center">
                    <div class="text-6xl mb-4">๐</div>
                    <h3 class="text-xl font-bold text-gray-800 mb-4">ุฏูุฑู ุขุฒูุงุด ุจู ูพุงุงู ุฑุณุฏ</h3>
                    <p class="text-gray-600 mb-6">ุจุฑุง ุงุฏุงูู ุงุณุชูุงุฏู ุงุฒ ุงูฺฉุงูุงุชุ ูุทูุงู ุงุดุชุฑุงฺฉ ุชูู ฺฉูุฏ</p>
                    <button onclick="showSubscriptionModal(); this.parentElement.parentElement.remove();" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-medium">
                        ูุดุงูุฏู ูพูุงูโูุง
                    </button>
                </div>
            `;
            document.body.appendChild(overlay);
        }

        // Theme Management
        function changeTheme() {
            const theme = document.getElementById('themeSelector').value;
            document.body.setAttribute('data-theme', theme);
            localStorage.setItem('selectedTheme', theme);
        }

        // Load saved theme
        function loadTheme() {
            const savedTheme = localStorage.getItem('selectedTheme') || 'light';
            document.getElementById('themeSelector').value = savedTheme;
            document.body.setAttribute('data-theme', savedTheme);
        }

        // Modal Management
        function showModal(modalId) {
            document.getElementById(modalId).classList.add('show');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }

        function showHelp() {
            showModal('helpModal');
        }

        function showSupport() {
            showModal('supportModal');
        }

        // Contact Support Functions
        function contactSupport(platform) {
            let contactUrl = '';
            
            switch(platform) {
                case 'phone':
                    contactUrl = 'tel:+989936565106';
                    break;
                case 'telegram':
                    contactUrl = 'https://t.me/Spaincar7';
                    break;
                case 'whatsapp':
                    contactUrl = 'https://wa.me/989199764157';
                    break;
                case 'eitaa':
                    contactUrl = 'https://eitaa.com/Spaincar77';
                    break;
                default:
                    return;
            }
            
            window.open(contactUrl, '_blank');
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('show');
            }
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('accountingPeople', JSON.stringify(people));
            localStorage.setItem('accountingTransactions', JSON.stringify(transactions));
            updateSummary();
            updateCharts();
            renderIndividualTables();
        }

        // Purchase subscription function
        function purchaseSubscription(planType) {
            const plans = {
                '1month': { name: 'ฺฉ ูุงูู', price: 'นน,ฐฐฐ ุชููุงู', duration: 30 },
                '3month': { name: 'ุณู ูุงูู', price: 'ฑนน,ฐฐฐ ุชููุงู', duration: 90 },
                '6month': { name: 'ุดุด ูุงูู', price: 'ณนน,ฐฐฐ ุชููุงู', duration: 180 },
                '12month': { name: 'ฺฉ ุณุงูู', price: 'ตนน,ฐฐฐ ุชููุงู', duration: 365 },
                '5year': { name: 'ูพูุฌ ุณุงูู', price: 'ฑ,ตฐฐ,ฐฐฐ ุชููุงู', duration: 1825 },
                'lifetime': { name: 'ูุงูุญุฏูุฏ', price: 'ณ,ฐฐฐ,ฐฐฐ ุชููุงู', duration: 36500 }
            };
            
            const selectedPlan = plans[planType];
            const message = `ุณูุงู! ูโุฎูุงูู ุงุดุชุฑุงฺฉ ${selectedPlan.name} ุจู ููุช ${selectedPlan.price} ุฑุง ุฎุฑุฏุงุฑ ฺฉูู.`;
            
            // Show purchase confirmation modal
            const purchaseModal = document.createElement('div');
            purchaseModal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            purchaseModal.innerHTML = `
                <div class="bg-white rounded-xl p-8 max-w-lg mx-4 text-center">
                    <div class="text-6xl mb-4">๐</div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-4">ุฎุฑุฏ ุงุดุชุฑุงฺฉ ${selectedPlan.name}</h3>
                    <div class="bg-gradient-to-r from-blue-100 to-purple-100 rounded-lg p-6 mb-6">
                        <div class="text-3xl font-bold text-blue-600 mb-2">${selectedPlan.price}</div>
                        <div class="text-gray-700">ูุฏุช ุงุดุชุฑุงฺฉ: ${selectedPlan.name}</div>
                    </div>
                    
                    <p class="text-gray-600 mb-6">ุจุฑุง ุฎุฑุฏ ุงู ุงุดุชุฑุงฺฉุ ุจุง ฺฉ ุงุฒ ุฑุงูโูุง ุฒุฑ ุชูุงุณ ุจฺฏุฑุฏ:</p>
                    
                    <div class="grid grid-cols-1 gap-3 mb-6">
                        <button onclick="contactSupportWithMessage('phone', '${message}'); this.parentElement.parentElement.parentElement.remove();" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-3 rounded-lg transition-all flex items-center justify-center">
                            ๐ ุชูุงุณ ุชููู: ฐนนณถตถตตฑฐถ
                        </button>
                        <button onclick="contactSupportWithMessage('telegram', '${message}'); this.parentElement.parentElement.parentElement.remove();" class="w-full bg-blue-400 hover:bg-blue-500 text-white px-4 py-3 rounded-lg transition-all flex items-center justify-center">
                            ๐ฑ ุชูฺฏุฑุงู: @Spaincar7
                        </button>
                        <button onclick="contactSupportWithMessage('whatsapp', '${message}'); this.parentElement.parentElement.parentElement.remove();" class="w-full bg-green-500 hover:bg-green-600 text-white px-4 py-3 rounded-lg transition-all flex items-center justify-center">
                            ๐ฌ ูุงุชุณุงูพ: ฐนฑนนทถดฑตท
                        </button>
                        <button onclick="contactSupportWithMessage('eitaa', '${message}'); this.parentElement.parentElement.parentElement.remove();" class="w-full bg-purple-500 hover:bg-purple-600 text-white px-4 py-3 rounded-lg transition-all flex items-center justify-center">
                            ๐ต ุงุชุง: @Spaincar77
                        </button>
                    </div>
                    
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4">
                        <div class="flex items-center justify-center mb-2">
                            <span class="text-2xl ml-2">โก</span>
                            <h4 class="font-bold text-yellow-800">ูุฑุขูุฏ ุฎุฑุฏ:</h4>
                        </div>
                        <ul class="text-yellow-700 text-sm space-y-1">
                            <li>ฑ. ุจุง ูพุดุชุจุงู ุชูุงุณ ุจฺฏุฑุฏ</li>
                            <li>ฒ. ูุจูุบ ุฑุง ูพุฑุฏุงุฎุช ฺฉูุฏ</li>
                            <li>ณ. ุงุดุชุฑุงฺฉ ููุฑุงู ูุนุงู ูโุดูุฏ</li>
                        </ul>
                    </div>
                    
                    <div class="flex gap-3">
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" class="w-full bg-gray-300 hover:bg-gray-400 text-gray-700 px-4 py-2 rounded-lg transition-all">
                            ุจุณุชู
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(purchaseModal);
        }



        // Contact support with pre-filled message
        function contactSupportWithMessage(platform, message) {
            const encodedMessage = encodeURIComponent(message);
            let contactUrl = '';
            
            switch(platform) {
                case 'phone':
                    contactUrl = 'tel:+989936565106';
                    break;
                case 'telegram':
                    contactUrl = `https://t.me/Spaincar7?text=${encodedMessage}`;
                    break;
                case 'whatsapp':
                    contactUrl = `https://wa.me/989199764157?text=${encodedMessage}`;
                    break;
                case 'eitaa':
                    contactUrl = `https://eitaa.com/Spaincar77?text=${encodedMessage}`;
                    break;
                default:
                    return;
            }
            
            window.open(contactUrl, '_blank');
        }

        // Update trial status display
        function updateTrialStatus() {
            const trialStatusElement = document.getElementById('trialStatus');
            if (!trialStatusElement) return;
            
            const subscriptionData = getUserSubscriptionData();
            if (!subscriptionData) return;
            
            const remainingDays = getRemainingTrialDays();
            
            if (subscriptionData.subscriptionType === 'trial') {
                if (remainingDays > 0) {
                    trialStatusElement.innerHTML = `โฐ ุขุฒูุงุด: ${remainingDays} ุฑูุฒ ุจุงูโูุงูุฏู`;
                    trialStatusElement.className = 'bg-yellow-100 border border-yellow-300 rounded-lg px-4 py-2 text-sm font-medium text-yellow-800';
                } else {
                    trialStatusElement.innerHTML = `๐ ุฏูุฑู ุขุฒูุงุด ูพุงุงู ุงูุช`;
                    trialStatusElement.className = 'bg-red-100 border border-red-300 rounded-lg px-4 py-2 text-sm font-medium text-red-800';
                }
            } else {
                const plans = {
                    '1month': 'ฺฉ ูุงูู',
                    '3month': 'ุณู ูุงูู', 
                    '6month': 'ุดุด ูุงูู',
                    '12month': 'ฺฉ ุณุงูู',
                    '5year': 'ูพูุฌ ุณุงูู',
                    'lifetime': 'ูุงูุญุฏูุฏ'
                };
                
                const planName = plans[subscriptionData.subscriptionType] || 'ูุนุงู';
                trialStatusElement.innerHTML = `โ ุงุดุชุฑุงฺฉ ${planName}`;
                trialStatusElement.className = 'bg-green-100 border border-green-300 rounded-lg px-4 py-2 text-sm font-medium text-green-800';
            }
        }

        // Add person
        document.getElementById('personForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Check subscription status before allowing action
            if (!checkSubscriptionStatus()) {
                blockTransactionFeatures();
                return;
            }
            
            const name = document.getElementById('personName').value;
            const phone = document.getElementById('personPhone').value;
            const address = document.getElementById('personAddress').value;
            const photoFile = document.getElementById('personPhoto').files[0];
            
            const person = {
                id: Date.now(),
                name: name,
                phone: phone,
                address: address,
                photo: null,
                balance: 0
            };
            
            if (photoFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    person.photo = e.target.result;
                    people.push(person);
                    saveData();
                    renderPeople();
                    updateTransactionSelect();
                    document.getElementById('personForm').reset();
                };
                reader.readAsDataURL(photoFile);
            } else {
                people.push(person);
                saveData();
                renderPeople();
                updateTransactionSelect();
                document.getElementById('personForm').reset();
            }
        });

        // Add transaction
        document.getElementById('transactionForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Check subscription status before allowing action
            if (!checkSubscriptionStatus()) {
                blockTransactionFeatures();
                return;
            }
            
            const personId = parseInt(document.getElementById('transactionPerson').value);
            const type = document.getElementById('transactionType').value;
            const amount = parseFloat(document.getElementById('transactionAmount').value);
            const description = document.getElementById('transactionDescription').value;
            
            const transaction = {
                id: Date.now(),
                personId: personId,
                type: type,
                amount: amount,
                description: description,
                date: new Date().toLocaleDateString('fa-IR')
            };
            
            transactions.push(transaction);
            
            // Update person balance
            const person = people.find(p => p.id === personId);
            if (person) {
                if (type === 'debt') {
                    person.balance -= amount; // We owe them
                } else {
                    person.balance += amount; // They owe us
                }
            }
            
            saveData();
            renderPeople();
            renderTransactions();
            document.getElementById('transactionForm').reset();
        });

        // Render people
        function renderPeople() {
            const peopleList = document.getElementById('peopleList');
            
            if (people.length === 0) {
                peopleList.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <span class="text-6xl">๐ค</span>
                        <p class="mt-4 text-lg">ูููุฒ ุดุฎุต ุงุถุงูู ูุดุฏู ุงุณุช</p>
                        <p class="text-sm text-gray-400">ุงุฒ ูุฑู ุณูุช ุฑุงุณุช ุดุฎุต ุฌุฏุฏ ุงุถุงูู ฺฉูุฏ</p>
                    </div>
                `;
                return;
            }
            
            peopleList.innerHTML = people.map(person => {
                const balanceColor = person.balance > 0 ? 'text-green-600' : person.balance < 0 ? 'text-red-600' : 'text-gray-600';
                const balanceIcon = person.balance > 0 ? '๐' : person.balance < 0 ? '๐' : 'โ๏ธ';
                const balanceText = person.balance > 0 ? 'ุทูุจฺฉุงุฑ' : person.balance < 0 ? 'ุจุฏูฺฉุงุฑ' : 'ุชุณูู';
                
                return `
                    <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-all duration-200 fade-in theme-bg-secondary">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-4 space-x-reverse">
                                <div class="w-16 h-16 rounded-full overflow-hidden bg-gray-200 flex items-center justify-center">
                                    ${person.photo ? 
                                        `<img src="${person.photo}" alt="${person.name}" class="w-full h-full object-cover">` :
                                        `<span class="text-2xl">๐ค</span>`
                                    }
                                </div>
                                <div>
                                    <h3 class="font-bold text-lg theme-text-primary">${person.name}</h3>
                                    <p class="theme-text-secondary text-sm">${person.phone || 'ุจุฏูู ุดูุงุฑู ุชููู'}</p>
                                    <p class="theme-text-secondary text-xs">${person.address || 'ุจุฏูู ุขุฏุฑุณ'}</p>
                                </div>
                            </div>
                            <div class="text-left">
                                <div class="flex items-center ${balanceColor} font-bold text-lg">
                                    <span class="ml-2">${balanceIcon}</span>
                                    ${Math.abs(person.balance).toLocaleString()} ุชููุงู
                                </div>
                                <p class="text-sm ${balanceColor}">${balanceText}</p>
                                <div class="flex gap-2 mt-2">
                                    <button onclick="generatePersonReport(${person.id})" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-xs transition-all">
                                        ๐ ฺฏุฒุงุฑุด
                                    </button>
                                    <button onclick="deletePerson(${person.id})" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-xs transition-all">
                                        ๐๏ธ ุญุฐู
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Render transactions
        function renderTransactions() {
            const transactionsList = document.getElementById('transactionsList');
            
            if (transactions.length === 0) {
                transactionsList.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <span class="text-6xl">๐ธ</span>
                        <p class="mt-4 text-lg">ูููุฒ ุชุฑุงฺฉูุด ุซุจุช ูุดุฏู ุงุณุช</p>
                        <p class="text-sm text-gray-400">ุงุฒ ูุฑู ุณูุช ุฑุงุณุช ุชุฑุงฺฉูุด ุฌุฏุฏ ุงุถุงูู ฺฉูุฏ</p>
                    </div>
                `;
                return;
            }
            
            const sortedTransactions = [...transactions].reverse();
            
            transactionsList.innerHTML = sortedTransactions.map(transaction => {
                const person = people.find(p => p.id === transaction.personId);
                const typeColor = transaction.type === 'credit' ? 'text-green-600' : 'text-red-600';
                const typeIcon = transaction.type === 'credit' ? '๐' : '๐';
                const typeText = transaction.type === 'credit' ? 'ุทูุจฺฉุงุฑ' : 'ุจุฏูฺฉุงุฑ';
                
                return `
                    <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-all duration-200 fade-in">
                        <div class="flex items-center justify-between">
                            <div class="flex-1">
                                <div class="flex items-center space-x-3 space-x-reverse mb-2">
                                    <span class="text-xl">${typeIcon}</span>
                                    <h4 class="font-bold text-gray-800">${person ? person.name : 'ุดุฎุต ุญุฐู ุดุฏู'}</h4>
                                    <span class="text-sm text-gray-500">${transaction.date}</span>
                                </div>
                                <p class="text-gray-600 text-sm mb-2">${transaction.description || 'ุจุฏูู ุชูุถุญุงุช'}</p>
                                <div class="flex items-center space-x-2 space-x-reverse">
                                    <span class="${typeColor} font-bold">${transaction.amount.toLocaleString()} ุชููุงู</span>
                                    <span class="text-sm ${typeColor}">(${typeText})</span>
                                </div>
                            </div>
                            <button onclick="deleteTransaction(${transaction.id})" class="bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded text-sm transition-all">
                                ๐๏ธ ุญุฐู
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Update transaction select
        function updateTransactionSelect() {
            const select = document.getElementById('transactionPerson');
            select.innerHTML = '<option value="">ุดุฎุต ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</option>' +
                people.map(person => `<option value="${person.id}">${person.name}</option>`).join('');
        }

        // Update summary
        function updateSummary() {
            const totalCredit = people.reduce((sum, person) => sum + Math.max(0, person.balance), 0);
            const totalDebt = people.reduce((sum, person) => sum + Math.max(0, -person.balance), 0);
            
            document.getElementById('totalCredit').textContent = totalCredit.toLocaleString() + ' ุชููุงู';
            document.getElementById('totalDebt').textContent = totalDebt.toLocaleString() + ' ุชููุงู';
            document.getElementById('totalPeople').textContent = people.length + ' ููุฑ';
        }

        // Delete person
        function deletePerson(id) {
            if (confirm('ุขุง ุงุฒ ุญุฐู ุงู ุดุฎุต ุงุทููุงู ุฏุงุฑุฏุ')) {
                people = people.filter(p => p.id !== id);
                transactions = transactions.filter(t => t.personId !== id);
                saveData();
                renderPeople();
                renderTransactions();
                updateTransactionSelect();
            }
        }

        // Delete transaction
        function deleteTransaction(id) {
            if (confirm('ุขุง ุงุฒ ุญุฐู ุงู ุชุฑุงฺฉูุด ุงุทููุงู ุฏุงุฑุฏุ')) {
                const transaction = transactions.find(t => t.id === id);
                if (transaction) {
                    const person = people.find(p => p.id === transaction.personId);
                    if (person) {
                        // Reverse the balance change
                        if (transaction.type === 'debt') {
                            person.balance += transaction.amount;
                        } else {
                            person.balance -= transaction.amount;
                        }
                    }
                }
                transactions = transactions.filter(t => t.id !== id);
                saveData();
                renderPeople();
                renderTransactions();
            }
        }

        // Export to PDF
        function exportToPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Persian date helper
            function toPersianDate(dateStr) {
                return new Date().toLocaleDateString('fa-IR');
            }
            
            // Persian number converter
            function toPersianNumbers(str) {
                const persianDigits = 'ฐฑฒณดตถทธน';
                const englishDigits = '0123456789';
                return str.toString().replace(/[0-9]/g, function(w) {
                    return persianDigits[englishDigits.indexOf(w)];
                });
            }
            
            // Add Persian font support
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(24);
            
            let yPosition = 35;
            
            // Title with Persian styling
            doc.setTextColor(0, 100, 200);
            doc.text('ฺฏุฒุงุฑุด ฺฉู ุญุณุงุจุฏุงุฑ', 105, yPosition, { align: 'center' });
            yPosition += 30;
            
            // Add decorative line
            doc.setLineWidth(1);
            doc.setDrawColor(0, 100, 200);
            doc.line(30, yPosition, 180, yPosition);
            yPosition += 20;
            
            // Summary section with Persian formatting
            const totalCredit = people.reduce((sum, person) => sum + Math.max(0, person.balance), 0);
            const totalDebt = people.reduce((sum, person) => sum + Math.max(0, -person.balance), 0);
            
            // Summary box
            doc.setDrawColor(200, 200, 200);
            doc.setLineWidth(0.5);
            doc.rect(20, yPosition - 5, 170, 50);
            
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(18);
            doc.setTextColor(0, 150, 0);
            doc.text('ุฎูุงุตู ูุงู:', 25, yPosition + 8);
            yPosition += 20;
            
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(14);
            
            // Credit section with Persian numbers
            doc.setTextColor(0, 150, 0);
            doc.text(`ฺฉู ุทูุจ: ${toPersianNumbers(totalCredit.toLocaleString())} ุชููุงู`, 30, yPosition);
            yPosition += 12;
            
            // Debt section with Persian numbers
            doc.setTextColor(200, 0, 0);
            doc.text(`ฺฉู ุจุฏู: ${toPersianNumbers(totalDebt.toLocaleString())} ุชููุงู`, 30, yPosition);
            yPosition += 12;
            
            // People count with Persian numbers
            doc.setTextColor(0, 0, 0);
            doc.text(`ุชุนุฏุงุฏ ุงุดุฎุงุต: ${toPersianNumbers(people.length)} ููุฑ`, 30, yPosition);
            yPosition += 25;
            
            // People list section
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(18);
            doc.setTextColor(0, 100, 200);
            doc.text('ุฌุฒุฆุงุช ุงุดุฎุงุต:', 20, yPosition);
            yPosition += 20;
            
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(12);
            
            people.forEach((person, index) => {
                // Check for new page
                if (yPosition > 240) {
                    doc.addPage();
                    yPosition = 30;
                    
                    // Repeat header on new page
                    doc.setFont('helvetica', 'bold');
                    doc.setFontSize(16);
                    doc.setTextColor(0, 100, 200);
                    doc.text('ุงุฏุงูู ุฌุฒุฆุงุช ุงุดุฎุงุต:', 20, yPosition);
                    yPosition += 20;
                    doc.setFont('helvetica', 'normal');
                    doc.setFontSize(12);
                }
                
                // Person box
                const boxHeight = 45;
                doc.setDrawColor(220, 220, 220);
                doc.setLineWidth(0.3);
                doc.rect(20, yPosition - 5, 170, boxHeight);
                
                // Person header with Persian number
                doc.setFont('helvetica', 'bold');
                doc.setTextColor(0, 0, 0);
                doc.text(`${toPersianNumbers(index + 1)}. ${person.name}`, 25, yPosition + 5);
                yPosition += 12;
                
                doc.setFont('helvetica', 'normal');
                doc.setFontSize(11);
                
                // Contact info with Persian text
                if (person.phone) {
                    doc.setTextColor(80, 80, 80);
                    doc.text(`ุดูุงุฑู ุชูุงุณ: ${toPersianNumbers(person.phone)}`, 30, yPosition);
                    yPosition += 10;
                }
                
                if (person.address) {
                    doc.setTextColor(80, 80, 80);
                    const addressLines = doc.splitTextToSize(`ูุดุงู: ${person.address}`, 150);
                    doc.text(addressLines, 30, yPosition);
                    yPosition += addressLines.length * 10;
                }
                
                // Balance with Persian numbers and text
                const balanceText = person.balance > 0 ? 
                    `ููุฌูุฏ: ${toPersianNumbers(person.balance.toLocaleString())} ุชููุงู (ุทูุจฺฉุงุฑ)` : 
                    person.balance < 0 ? 
                    `ููุฌูุฏ: ${toPersianNumbers(Math.abs(person.balance).toLocaleString())} ุชููุงู (ุจุฏูฺฉุงุฑ)` : 
                    `ููุฌูุฏ: ุชุณูู ุดุฏู`;
                
                if (person.balance > 0) {
                    doc.setTextColor(0, 150, 0);
                } else if (person.balance < 0) {
                    doc.setTextColor(200, 0, 0);
                } else {
                    doc.setTextColor(100, 100, 100);
                }
                
                doc.setFont('helvetica', 'bold');
                doc.text(balanceText, 30, yPosition);
                doc.setTextColor(0, 0, 0);
                yPosition += 20;
            });
            
            // Add Persian footer
            const pageCount = doc.internal.getNumberOfPages();
            for (let i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                
                // Footer line
                doc.setDrawColor(200, 200, 200);
                doc.setLineWidth(0.5);
                doc.line(20, 280, 190, 280);
                
                doc.setFont('helvetica', 'normal');
                doc.setFontSize(10);
                doc.setTextColor(120, 120, 120);
                
                // Persian date and time
                const now = new Date();
                const persianDate = now.toLocaleDateString('fa-IR');
                const persianTime = now.toLocaleTimeString('fa-IR');
                doc.text(`ุชุงุฑุฎ ุชููุฏ ฺฏุฒุงุฑุด: ${toPersianNumbers(persianDate)} - ุณุงุนุช: ${toPersianNumbers(persianTime)}`, 20, 285);
                
                // Persian page numbers
                doc.text(`ุตูุญู ${toPersianNumbers(i)} ุงุฒ ${toPersianNumbers(pageCount)}`, 170, 285);
                
                // Report title in footer
                doc.text('ฺฏุฒุงุฑุด ุญุณุงุจุฏุงุฑ', 105, 285, { align: 'center' });
            }
            
            // Save with Persian filename
            const persianDate = new Date().toLocaleDateString('fa-IR').replace(/\//g, '-');
            doc.save(`ฺฏุฒุงุฑุด-ุญุณุงุจุฏุงุฑ-${toPersianNumbers(persianDate)}.pdf`);
        }

        // Share data
        function shareData() {
            const data = {
                people: people,
                transactions: transactions,
                exportDate: new Date().toLocaleDateString('fa-IR')
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = 'accounting-data.json';
            a.click();
            
            URL.revokeObjectURL(url);
            
            // Also try to use Web Share API if available
            if (navigator.share) {
                navigator.share({
                    title: 'ุฏุงุฏูโูุง ุญุณุงุจุฏุงุฑ',
                    text: 'ูุงู ุฏุงุฏูโูุง ุญุณุงุจุฏุงุฑ ูู',
                    files: [new File([dataBlob], 'accounting-data.json', {type: 'application/json'})]
                }).catch(console.error);
            }
        }

        // Update 3D Charts
        function updateCharts() {
            updatePieChart();
            updateBarChart();
            update3DSurface();
        }

        // Pie Chart for Debt/Credit Distribution
        function updatePieChart() {
            if (people.length === 0) {
                document.getElementById('pieChart').innerHTML = '<div class="flex items-center justify-center h-full text-gray-500"><span class="text-4xl">๐</span><p class="mr-3">ุฏุงุฏูโุง ุจุฑุง ููุงุด ูุฌูุฏ ูุฏุงุฑุฏ</p></div>';
                return;
            }

            const debtors = people.filter(p => p.balance < 0);
            const creditors = people.filter(p => p.balance > 0);
            const settled = people.filter(p => p.balance === 0);

            const data = [{
                values: [
                    debtors.reduce((sum, p) => sum + Math.abs(p.balance), 0),
                    creditors.reduce((sum, p) => sum + p.balance, 0),
                    settled.length * 1000 // Just for visualization
                ],
                labels: ['ุจุฏูฺฉุงุฑุงู', 'ุทูุจฺฉุงุฑุงู', 'ุชุณูู ุดุฏู'],
                type: 'pie',
                hole: 0.4,
                marker: {
                    colors: ['#ef4444', '#10b981', '#6b7280']
                },
                textinfo: 'label+percent',
                textposition: 'outside'
            }];

            const layout = {
                title: {
                    text: 'ุชูุฒุน ุจุฏู ู ุทูุจ',
                    font: { size: 16 }
                },
                showlegend: true,
                margin: { t: 50, b: 50, l: 50, r: 50 }
            };

            Plotly.newPlot('pieChart', data, layout, {responsive: true});
        }

        // Bar Chart for Individual Balances
        function updateBarChart() {
            if (people.length === 0) {
                document.getElementById('barChart').innerHTML = '<div class="flex items-center justify-center h-full text-gray-500"><span class="text-4xl">๐</span><p class="mr-3">ุฏุงุฏูโุง ุจุฑุง ููุงุด ูุฌูุฏ ูุฏุงุฑุฏ</p></div>';
                return;
            }

            const data = [{
                x: people.map(p => p.name),
                y: people.map(p => p.balance),
                type: 'bar',
                marker: {
                    color: people.map(p => p.balance >= 0 ? '#10b981' : '#ef4444')
                },
                text: people.map(p => p.balance.toLocaleString() + ' ุชููุงู'),
                textposition: 'auto'
            }];

            const layout = {
                title: {
                    text: 'ููุฌูุฏ ูุฑ ุดุฎุต',
                    font: { size: 16 }
                },
                xaxis: { title: 'ุงุดุฎุงุต' },
                yaxis: { title: 'ููุฌูุฏ (ุชููุงู)' },
                margin: { t: 50, b: 100, l: 80, r: 50 }
            };

            Plotly.newPlot('barChart', data, layout, {responsive: true});
        }

        // 3D Surface Chart for Transactions Over Time
        function update3DSurface() {
            if (transactions.length === 0) {
                document.getElementById('surface3D').innerHTML = '<div class="flex items-center justify-center h-full text-gray-500"><span class="text-4xl">๐</span><p class="mr-3">ุฏุงุฏูโุง ุจุฑุง ููุงุด ูุฌูุฏ ูุฏุงุฑุฏ</p></div>';
                return;
            }

            // Create a 3D scatter plot of transactions
            const data = [{
                x: transactions.map((t, index) => index), // Transaction index
                y: transactions.map(t => t.personId), // Person ID
                z: transactions.map(t => t.amount), // Amount
                mode: 'markers',
                type: 'scatter3d',
                marker: {
                    size: 8,
                    color: transactions.map(t => t.type === 'credit' ? '#10b981' : '#ef4444'),
                    opacity: 0.8
                },
                text: transactions.map(t => {
                    const person = people.find(p => p.id === t.personId);
                    return `${person ? person.name : 'ูุงูุดุฎุต'}<br>${t.amount.toLocaleString()} ุชููุงู<br>${t.date}`;
                }),
                hovertemplate: '%{text}<extra></extra>'
            }];

            const layout = {
                title: {
                    text: 'ูููุฏุงุฑ ุณู ุจุนุฏ ุชุฑุงฺฉูุดโูุง',
                    font: { size: 16 }
                },
                scene: {
                    xaxis: { title: 'ุชุฑุชุจ ุชุฑุงฺฉูุด' },
                    yaxis: { title: 'ุดูุงุณู ุดุฎุต' },
                    zaxis: { title: 'ูุจูุบ (ุชููุงู)' }
                },
                margin: { t: 50, b: 50, l: 50, r: 50 }
            };

            Plotly.newPlot('surface3D', data, layout, {responsive: true});
        }

        // Render Individual Tables
        function renderIndividualTables() {
            const tablesContainer = document.getElementById('individualTables');
            
            if (people.length === 0) {
                tablesContainer.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <span class="text-6xl">๐</span>
                        <p class="mt-4 text-lg">ูููุฒ ุดุฎุต ุงุถุงูู ูุดุฏู ุงุณุช</p>
                        <p class="text-sm text-gray-400">ูพุณ ุงุฒ ุงูุฒูุฏู ุงุดุฎุงุตุ ุฌุฏุงูู ุฌุฒุฆุงุช ููุงุด ุฏุงุฏู ูโุดูุฏ</p>
                    </div>
                `;
                return;
            }

            tablesContainer.innerHTML = people.map(person => {
                const personTransactions = transactions.filter(t => t.personId === person.id);
                const balanceColor = person.balance > 0 ? 'text-green-600' : person.balance < 0 ? 'text-red-600' : 'text-gray-600';
                const balanceIcon = person.balance > 0 ? '๐' : person.balance < 0 ? '๐' : 'โ๏ธ';
                
                return `
                    <div class="border border-gray-200 rounded-lg p-6 mb-6 fade-in">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center space-x-4 space-x-reverse">
                                <div class="w-16 h-16 rounded-full overflow-hidden bg-gray-200 flex items-center justify-center">
                                    ${person.photo ? 
                                        `<img src="${person.photo}" alt="${person.name}" class="w-full h-full object-cover">` :
                                        `<span class="text-2xl">๐ค</span>`
                                    }
                                </div>
                                <div>
                                    <h3 class="text-xl font-bold text-gray-800">${person.name}</h3>
                                    <p class="text-gray-600">${person.phone || 'ุจุฏูู ุดูุงุฑู ุชููู'}</p>
                                    <p class="text-gray-500 text-sm">${person.address || 'ุจุฏูู ุขุฏุฑุณ'}</p>
                                </div>
                            </div>
                            <div class="text-left">
                                <div class="flex items-center ${balanceColor} font-bold text-xl">
                                    <span class="ml-2">${balanceIcon}</span>
                                    ${Math.abs(person.balance).toLocaleString()} ุชููุงู
                                </div>
                                <p class="text-sm ${balanceColor}">${person.balance > 0 ? 'ุทูุจฺฉุงุฑ' : person.balance < 0 ? 'ุจุฏูฺฉุงุฑ' : 'ุชุณูู'}</p>
                            </div>
                        </div>
                        
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h4 class="font-semibold text-gray-800 mb-3 flex items-center">
                                <span class="ml-2">๐</span>
                                ุชุงุฑุฎฺู ุชุฑุงฺฉูุดโูุง (${personTransactions.length} ุชุฑุงฺฉูุด)
                            </h4>
                            
                            ${personTransactions.length === 0 ? 
                                '<p class="text-gray-500 text-center py-4">ูฺ ุชุฑุงฺฉูุด ุซุจุช ูุดุฏู ุงุณุช</p>' :
                                `<div class="overflow-x-auto">
                                    <table class="w-full text-sm">
                                        <thead>
                                            <tr class="bg-gray-200 text-gray-700">
                                                <th class="px-4 py-2 text-right rounded-tr-lg">ุชุงุฑุฎ</th>
                                                <th class="px-4 py-2 text-right">ููุน</th>
                                                <th class="px-4 py-2 text-right">ูุจูุบ</th>
                                                <th class="px-4 py-2 text-right rounded-tl-lg">ุชูุถุญุงุช</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            ${personTransactions.map((transaction, index) => `
                                                <tr class="${index % 2 === 0 ? 'bg-white' : 'bg-gray-50'} border-b border-gray-200">
                                                    <td class="px-4 py-3">${transaction.date}</td>
                                                    <td class="px-4 py-3">
                                                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${
                                                            transaction.type === 'credit' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'
                                                        }">
                                                            ${transaction.type === 'credit' ? '๐ ุทูุจฺฉุงุฑ' : '๐ ุจุฏูฺฉุงุฑ'}
                                                        </span>
                                                    </td>
                                                    <td class="px-4 py-3 font-medium ${transaction.type === 'credit' ? 'text-green-600' : 'text-red-600'}">
                                                        ${transaction.amount.toLocaleString()} ุชููุงู
                                                    </td>
                                                    <td class="px-4 py-3 text-gray-600">
                                                        ${transaction.description || 'ุจุฏูู ุชูุถุญุงุช'}
                                                    </td>
                                                </tr>
                                            `).join('')}
                                        </tbody>
                                    </table>
                                </div>`
                            }
                            
                            <div class="mt-4 grid grid-cols-3 gap-4 text-center">
                                <div class="bg-green-100 rounded-lg p-3">
                                    <p class="text-green-800 font-semibold">ฺฉู ุทูุจ</p>
                                    <p class="text-green-600 font-bold">
                                        ${personTransactions.filter(t => t.type === 'credit').reduce((sum, t) => sum + t.amount, 0).toLocaleString()} ุชููุงู
                                    </p>
                                </div>
                                <div class="bg-red-100 rounded-lg p-3">
                                    <p class="text-red-800 font-semibold">ฺฉู ุจุฏู</p>
                                    <p class="text-red-600 font-bold">
                                        ${personTransactions.filter(t => t.type === 'debt').reduce((sum, t) => sum + t.amount, 0).toLocaleString()} ุชููุงู
                                    </p>
                                </div>
                                <div class="bg-blue-100 rounded-lg p-3">
                                    <p class="text-blue-800 font-semibold">ููุฌูุฏ ููุง</p>
                                    <p class="text-blue-600 font-bold ${balanceColor}">
                                        ${Math.abs(person.balance).toLocaleString()} ุชููุงู
                                    </p>
                                </div>
                            </div>
                            
                            <div class="mt-6 flex gap-3 flex-wrap justify-center">
                                <button onclick="downloadIndividualPDF(${person.id})" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition-all flex items-center">
                                    ๐ ุฏุงูููุฏ PDF
                                </button>
                                <button onclick="shareIndividualReport(${person.id}, 'telegram')" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-all flex items-center">
                                    ๐ฑ ุชูฺฏุฑุงู
                                </button>
                                <button onclick="shareIndividualReport(${person.id}, 'whatsapp')" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-all flex items-center">
                                    ๐ฌ ูุงุชุณุงูพ
                                </button>
                                <button onclick="shareIndividualReport(${person.id}, 'eitaa')" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg transition-all flex items-center">
                                    ๐ต ุงุชุง
                                </button>
                                <button onclick="shareIndividualReport(${person.id}, 'sms')" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg transition-all flex items-center">
                                    ๐จ ูพุงูฺฉ
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Generate Person Report
        function generatePersonReport(personId) {
            const person = people.find(p => p.id === personId);
            if (!person) return;

            currentPersonReport = person;
            const personTransactions = transactions.filter(t => t.personId === personId);
            
            const totalCredit = personTransactions.filter(t => t.type === 'credit').reduce((sum, t) => sum + t.amount, 0);
            const totalDebt = personTransactions.filter(t => t.type === 'debt').reduce((sum, t) => sum + t.amount, 0);
            
            const reportContent = `
                <div class="space-y-6">
                    <div class="text-center">
                        <div class="w-24 h-24 rounded-full overflow-hidden bg-gray-200 flex items-center justify-center mx-auto mb-4">
                            ${person.photo ? 
                                `<img src="${person.photo}" alt="${person.name}" class="w-full h-full object-cover">` :
                                `<span class="text-4xl">๐ค</span>`
                            }
                        </div>
                        <h3 class="text-2xl font-bold theme-text-primary">${person.name}</h3>
                        <p class="theme-text-secondary">${person.phone || 'ุจุฏูู ุดูุงุฑู ุชููู'}</p>
                        <p class="theme-text-secondary text-sm">${person.address || 'ุจุฏูู ุขุฏุฑุณ'}</p>
                    </div>
                    
                    <div class="grid grid-cols-3 gap-4 text-center">
                        <div class="bg-green-100 rounded-lg p-4">
                            <p class="text-green-800 font-semibold">ฺฉู ุทูุจ</p>
                            <p class="text-green-600 font-bold text-lg">${totalCredit.toLocaleString()} ุชููุงู</p>
                        </div>
                        <div class="bg-red-100 rounded-lg p-4">
                            <p class="text-red-800 font-semibold">ฺฉู ุจุฏู</p>
                            <p class="text-red-600 font-bold text-lg">${totalDebt.toLocaleString()} ุชููุงู</p>
                        </div>
                        <div class="bg-blue-100 rounded-lg p-4">
                            <p class="text-blue-800 font-semibold">ููุฌูุฏ ููุง</p>
                            <p class="text-blue-600 font-bold text-lg ${person.balance >= 0 ? 'text-green-600' : 'text-red-600'}">
                                ${Math.abs(person.balance).toLocaleString()} ุชููุงู
                            </p>
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="text-lg font-semibold mb-4">ุชุงุฑุฎฺู ุชุฑุงฺฉูุดโูุง</h4>
                        ${personTransactions.length === 0 ? 
                            '<p class="text-center theme-text-secondary py-4">ูฺ ุชุฑุงฺฉูุด ุซุจุช ูุดุฏู ุงุณุช</p>' :
                            `<div class="space-y-3 max-h-60 overflow-y-auto">
                                ${personTransactions.map(transaction => `
                                    <div class="border rounded-lg p-3 ${transaction.type === 'credit' ? 'border-green-200 bg-green-50' : 'border-red-200 bg-red-50'}">
                                        <div class="flex justify-between items-center">
                                            <div>
                                                <p class="font-medium ${transaction.type === 'credit' ? 'text-green-800' : 'text-red-800'}">
                                                    ${transaction.type === 'credit' ? '๐ ุทูุจฺฉุงุฑ' : '๐ ุจุฏูฺฉุงุฑ'}
                                                </p>
                                                <p class="text-sm text-gray-600">${transaction.description || 'ุจุฏูู ุชูุถุญุงุช'}</p>
                                            </div>
                                            <div class="text-left">
                                                <p class="font-bold ${transaction.type === 'credit' ? 'text-green-600' : 'text-red-600'}">
                                                    ${transaction.amount.toLocaleString()} ุชููุงู
                                                </p>
                                                <p class="text-xs text-gray-500">${transaction.date}</p>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>`
                        }
                    </div>
                </div>
            `;
            
            document.getElementById('personReportContent').innerHTML = reportContent;
            showModal('personReportModal');
        }

        // Download Person PDF
        function downloadPersonPDF() {
            if (!currentPersonReport) return;
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            const person = currentPersonReport;
            const personTransactions = transactions.filter(t => t.personId === person.id);
            
            // Persian date helper
            function toPersianDate(dateStr) {
                return new Date(dateStr).toLocaleDateString('fa-IR');
            }
            
            // Persian number converter
            function toPersianNumbers(str) {
                const persianDigits = 'ฐฑฒณดตถทธน';
                const englishDigits = '0123456789';
                return str.toString().replace(/[0-9]/g, function(w) {
                    return persianDigits[englishDigits.indexOf(w)];
                });
            }
            
            // Header with Persian formatting
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(24);
            doc.setTextColor(0, 100, 200);
            doc.text(`ฺฏุฒุงุฑุด ูุฑุฏ - ${person.name}`, 105, 30, { align: 'center' });
            
            let yPosition = 50;
            
            // Add decorative line
            doc.setLineWidth(1);
            doc.setDrawColor(0, 100, 200);
            doc.line(30, yPosition, 180, yPosition);
            yPosition += 20;
            
            // Personal Information Section with box
            doc.setDrawColor(200, 200, 200);
            doc.setLineWidth(0.5);
            doc.rect(20, yPosition - 5, 170, 40);
            
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(16);
            doc.setTextColor(0, 100, 200);
            doc.text('ุงุทูุงุนุงุช ุดุฎุต:', 25, yPosition + 8);
            yPosition += 18;
            
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            
            if (person.phone) {
                doc.text(`ุดูุงุฑู ุชูุงุณ: ${toPersianNumbers(person.phone)}`, 30, yPosition);
                yPosition += 12;
            }
            
            if (person.address) {
                const addressLines = doc.splitTextToSize(`ูุดุงู: ${person.address}`, 150);
                doc.text(addressLines, 30, yPosition);
                yPosition += addressLines.length * 12;
            }
            
            yPosition += 15;
            
            // Financial Summary Section with box
            doc.setDrawColor(200, 200, 200);
            doc.rect(20, yPosition - 5, 170, 50);
            
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(16);
            doc.setTextColor(0, 150, 0);
            doc.text('ุฎูุงุตู ูุงู:', 25, yPosition + 8);
            yPosition += 18;
            
            const totalCredit = personTransactions.filter(t => t.type === 'credit').reduce((sum, t) => sum + t.amount, 0);
            const totalDebt = personTransactions.filter(t => t.type === 'debt').reduce((sum, t) => sum + t.amount, 0);
            
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(14);
            
            // Credit with Persian numbers
            doc.setTextColor(0, 150, 0);
            doc.text(`ฺฉู ุทูุจ: ${toPersianNumbers(totalCredit.toLocaleString())} ุชููุงู`, 30, yPosition);
            yPosition += 12;
            
            // Debt with Persian numbers
            doc.setTextColor(200, 0, 0);
            doc.text(`ฺฉู ุจุฏู: ${toPersianNumbers(totalDebt.toLocaleString())} ุชููุงู`, 30, yPosition);
            yPosition += 12;
            
            // Final balance with Persian numbers
            doc.setFont('helvetica', 'bold');
            const balanceColor = person.balance >= 0 ? [0, 150, 0] : [200, 0, 0];
            doc.setTextColor(...balanceColor);
            doc.text(`ููุฌูุฏ ููุง: ${toPersianNumbers(Math.abs(person.balance).toLocaleString())} ุชููุงู (${person.balance >= 0 ? 'ุทูุจฺฉุงุฑ' : 'ุจุฏูฺฉุงุฑ'})`, 30, yPosition);
            doc.setTextColor(0, 0, 0);
            yPosition += 25;
            
            // Transaction History Section
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(16);
            doc.setTextColor(0, 0, 200);
            doc.text(`ุชุงุฑุฎฺู ุชุฑุงฺฉูุดโูุง (${toPersianNumbers(personTransactions.length)} ุชุฑุงฺฉูุด):`, 20, yPosition);
            yPosition += 20;
            
            if (personTransactions.length === 0) {
                doc.setFont('helvetica', 'normal');
                doc.setFontSize(12);
                doc.setTextColor(150, 150, 150);
                doc.text('ูฺ ุชุฑุงฺฉูุด ุซุจุช ูุดุฏู ุงุณุช', 30, yPosition);
            } else {
                doc.setFont('helvetica', 'normal');
                doc.setFontSize(11);
                
                personTransactions.forEach((transaction, index) => {
                    // Check for new page
                    if (yPosition > 240) {
                        doc.addPage();
                        yPosition = 30;
                        
                        // Repeat header on new page
                        doc.setFont('helvetica', 'bold');
                        doc.setFontSize(14);
                        doc.setTextColor(0, 0, 200);
                        doc.text(`ุงุฏุงูู ุชุฑุงฺฉูุดโูุง ${person.name}`, 20, yPosition);
                        yPosition += 20;
                        doc.setFont('helvetica', 'normal');
                        doc.setFontSize(11);
                    }
                    
                    // Transaction box
                    const boxHeight = transaction.description ? 35 : 25;
                    doc.setDrawColor(220, 220, 220);
                    doc.setLineWidth(0.3);
                    doc.rect(20, yPosition - 3, 170, boxHeight);
                    
                    // Transaction number and date with Persian numbers
                    doc.setFont('helvetica', 'bold');
                    doc.setTextColor(0, 0, 0);
                    doc.text(`${toPersianNumbers(index + 1)}. ุชุงุฑุฎ: ${toPersianNumbers(toPersianDate(transaction.date))}`, 25, yPosition + 5);
                    
                    // Transaction type with Persian text
                    const typeText = transaction.type === 'credit' ? 'ุทูุจฺฉุงุฑ' : 'ุจุฏูฺฉุงุฑ';
                    const typeColor = transaction.type === 'credit' ? [0, 150, 0] : [200, 0, 0];
                    doc.setFont('helvetica', 'normal');
                    doc.setTextColor(...typeColor);
                    doc.text(`ููุน: ${typeText}`, 25, yPosition + 15);
                    
                    // Amount with Persian numbers
                    doc.setFont('helvetica', 'bold');
                    doc.text(`ูุจูุบ: ${toPersianNumbers(transaction.amount.toLocaleString())} ุชููุงู`, 100, yPosition + 15);
                    
                    // Description if exists
                    if (transaction.description) {
                        doc.setFont('helvetica', 'normal');
                        doc.setTextColor(80, 80, 80);
                        const descLines = doc.splitTextToSize(`ุชูุถุญุงุช: ${transaction.description}`, 160);
                        doc.text(descLines, 25, yPosition + 25);
                    }
                    
                    yPosition += boxHeight + 8;
                });
            }
            
            // Add Persian footer
            const pageCount = doc.internal.getNumberOfPages();
            for (let i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                
                // Footer line
                doc.setDrawColor(200, 200, 200);
                doc.setLineWidth(0.5);
                doc.line(20, 280, 190, 280);
                
                doc.setFont('helvetica', 'normal');
                doc.setFontSize(10);
                doc.setTextColor(120, 120, 120);
                
                // Persian date and time
                const now = new Date();
                const persianDate = now.toLocaleDateString('fa-IR');
                const persianTime = now.toLocaleTimeString('fa-IR');
                doc.text(`ุชุงุฑุฎ ุชููุฏ ฺฏุฒุงุฑุด: ${toPersianNumbers(persianDate)} - ุณุงุนุช: ${toPersianNumbers(persianTime)}`, 20, 285);
                
                // Persian page numbers
                doc.text(`ุตูุญู ${toPersianNumbers(i)} ุงุฒ ${toPersianNumbers(pageCount)}`, 170, 285);
                
                // Report title in footer
                doc.text(`ฺฏุฒุงุฑุด ${person.name}`, 105, 285, { align: 'center' });
            }
            
            // Save with Persian filename
            const persianDate = new Date().toLocaleDateString('fa-IR').replace(/\//g, '-');
            doc.save(`ฺฏุฒุงุฑุด-${person.name}-${toPersianNumbers(persianDate)}.pdf`);
        }

        // Share Person Report
        function sharePersonReport(platform) {
            if (!currentPersonReport) return;
            
            const person = currentPersonReport;
            const personTransactions = transactions.filter(t => t.personId === person.id);
            const totalCredit = personTransactions.filter(t => t.type === 'credit').reduce((sum, t) => sum + t.amount, 0);
            const totalDebt = personTransactions.filter(t => t.type === 'debt').reduce((sum, t) => sum + t.amount, 0);
            
            const reportText = `๐ ฺฏุฒุงุฑุด ุญุณุงุจุฏุงุฑ - ${person.name}

๐ฑ ุชููู: ${person.phone || 'ูุฏุงุฑุฏ'}
๐ ุขุฏุฑุณ: ${person.address || 'ูุฏุงุฑุฏ'}

๐ฐ ุฎูุงุตู ูุงู:
๐ ฺฉู ุทูุจ: ${totalCredit.toLocaleString()} ุชููุงู
๐ ฺฉู ุจุฏู: ${totalDebt.toLocaleString()} ุชููุงู
โ๏ธ ููุฌูุฏ ููุง: ${Math.abs(person.balance).toLocaleString()} ุชููุงู (${person.balance >= 0 ? 'ุทูุจฺฉุงุฑ' : 'ุจุฏูฺฉุงุฑ'})

๐ ุชุนุฏุงุฏ ุชุฑุงฺฉูุดโูุง: ${personTransactions.length}

ุชุงุฑุฎ ฺฏุฒุงุฑุด: ${new Date().toLocaleDateString('fa-IR')}`;

            const encodedText = encodeURIComponent(reportText);
            
            let shareUrl = '';
            
            switch(platform) {
                case 'telegram':
                    shareUrl = `https://t.me/share/url?url=${encodedText}`;
                    break;
                case 'whatsapp':
                    shareUrl = `https://wa.me/?text=${encodedText}`;
                    break;
                case 'eitaa':
                    shareUrl = `https://eitaa.com/share/url?url=${encodedText}`;
                    break;
                case 'sms':
                    shareUrl = `sms:?body=${encodedText}`;
                    break;
                default:
                    // Generic share
                    if (navigator.share) {
                        navigator.share({
                            title: `ฺฏุฒุงุฑุด ุญุณุงุจุฏุงุฑ - ${person.name}`,
                            text: reportText
                        });
                        return;
                    }
            }
            
            if (shareUrl) {
                window.open(shareUrl, '_blank');
            }
        }

        // Download Individual PDF
        function downloadIndividualPDF(personId) {
            const person = people.find(p => p.id === personId);
            if (!person) return;
            
            const personTransactions = transactions.filter(t => t.personId === personId);
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Persian date conversion
            function toPersianDate(dateStr) {
                return new Date(dateStr).toLocaleDateString('fa-IR');
            }
            
            // Persian number converter
            function toPersianNumbers(str) {
                const persianDigits = 'ฐฑฒณดตถทธน';
                const englishDigits = '0123456789';
                return str.toString().replace(/[0-9]/g, function(w) {
                    return persianDigits[englishDigits.indexOf(w)];
                });
            }
            
            // Header with Persian professional formatting
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(22);
            doc.setTextColor(0, 100, 200);
            doc.text(`ฺฏุฒุงุฑุด ุชูุตู - ${person.name}`, 105, 30, { align: 'center' });
            
            let yPosition = 50;
            
            // Add decorative line
            doc.setLineWidth(1);
            doc.setDrawColor(0, 100, 200);
            doc.line(30, yPosition, 180, yPosition);
            yPosition += 25;
            
            // Personal Information Box
            doc.setDrawColor(200, 200, 200);
            doc.setLineWidth(0.5);
            doc.rect(20, yPosition - 5, 170, 40);
            
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(16);
            doc.setTextColor(0, 100, 200);
            doc.text('ุงุทูุงุนุงุช ุดุฎุต', 25, yPosition + 8);
            yPosition += 18;
            
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            
            if (person.phone) {
                doc.text(`ุดูุงุฑู ุชูุงุณ: ${toPersianNumbers(person.phone)}`, 30, yPosition);
                yPosition += 12;
            }
            
            if (person.address) {
                const addressLines = doc.splitTextToSize(`ูุดุงู: ${person.address}`, 160);
                doc.text(addressLines, 30, yPosition);
                yPosition += addressLines.length * 12;
            }
            
            yPosition += 20;
            
            // Financial Summary Box
            doc.setDrawColor(200, 200, 200);
            doc.rect(20, yPosition - 5, 170, 50);
            
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(16);
            doc.setTextColor(0, 150, 0);
            doc.text('ุฎูุงุตู ูุงู', 25, yPosition + 8);
            yPosition += 18;
            
            const totalCredit = personTransactions.filter(t => t.type === 'credit').reduce((sum, t) => sum + t.amount, 0);
            const totalDebt = personTransactions.filter(t => t.type === 'debt').reduce((sum, t) => sum + t.amount, 0);
            
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(13);
            
            // Credit amount with Persian numbers
            doc.setTextColor(0, 150, 0);
            doc.text(`ฺฉู ุทูุจ: ${toPersianNumbers(totalCredit.toLocaleString())} ุชููุงู`, 30, yPosition);
            yPosition += 12;
            
            // Debt amount with Persian numbers
            doc.setTextColor(200, 0, 0);
            doc.text(`ฺฉู ุจุฏู: ${toPersianNumbers(totalDebt.toLocaleString())} ุชููุงู`, 30, yPosition);
            yPosition += 12;
            
            // Final balance with Persian numbers and emphasis
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(14);
            const balanceColor = person.balance >= 0 ? [0, 150, 0] : [200, 0, 0];
            doc.setTextColor(...balanceColor);
            doc.text(`ููุฌูุฏ ููุง: ${toPersianNumbers(Math.abs(person.balance).toLocaleString())} ุชููุงู (${person.balance >= 0 ? 'ุทูุจฺฉุงุฑ' : 'ุจุฏูฺฉุงุฑ'})`, 30, yPosition);
            
            yPosition += 30;
            
            // Transaction History Section
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(16);
            doc.setTextColor(0, 0, 200);
            doc.text(`ุชุงุฑุฎฺู ุชุฑุงฺฉูุดโูุง (${toPersianNumbers(personTransactions.length)} ููุฑุฏ)`, 20, yPosition);
            yPosition += 20;
            
            if (personTransactions.length === 0) {
                doc.setFont('helvetica', 'normal');
                doc.setFontSize(12);
                doc.setTextColor(150, 150, 150);
                doc.text('ูฺ ุชุฑุงฺฉูุด ุซุจุช ูุดุฏู ุงุณุช', 30, yPosition);
            } else {
                doc.setFont('helvetica', 'normal');
                doc.setFontSize(11);
                
                personTransactions.forEach((transaction, index) => {
                    // Check for new page
                    if (yPosition > 235) {
                        doc.addPage();
                        yPosition = 30;
                        
                        // Repeat header on new page
                        doc.setFont('helvetica', 'bold');
                        doc.setFontSize(14);
                        doc.setTextColor(0, 0, 200);
                        doc.text(`ุงุฏุงูู ุชุฑุงฺฉูุดโูุง ${person.name}`, 20, yPosition);
                        yPosition += 20;
                        doc.setFont('helvetica', 'normal');
                        doc.setFontSize(11);
                    }
                    
                    // Transaction box
                    const boxHeight = transaction.description ? 40 : 30;
                    doc.setDrawColor(220, 220, 220);
                    doc.setLineWidth(0.3);
                    doc.rect(20, yPosition - 3, 170, boxHeight);
                    
                    // Transaction number and date with Persian numbers
                    doc.setFont('helvetica', 'bold');
                    doc.setTextColor(0, 0, 0);
                    doc.text(`${toPersianNumbers(index + 1)}. ุชุงุฑุฎ: ${toPersianNumbers(toPersianDate(transaction.date))}`, 25, yPosition + 5);
                    
                    // Transaction type with Persian text
                    const typeText = transaction.type === 'credit' ? 'ุทูุจฺฉุงุฑ' : 'ุจุฏูฺฉุงุฑ';
                    const typeColor = transaction.type === 'credit' ? [0, 150, 0] : [200, 0, 0];
                    doc.setFont('helvetica', 'normal');
                    doc.setTextColor(...typeColor);
                    doc.text(`ููุน: ${typeText}`, 25, yPosition + 15);
                    
                    // Amount with Persian numbers and emphasis
                    doc.setFont('helvetica', 'bold');
                    doc.text(`ูุจูุบ: ${toPersianNumbers(transaction.amount.toLocaleString())} ุชููุงู`, 100, yPosition + 15);
                    
                    // Description if exists
                    if (transaction.description) {
                        doc.setFont('helvetica', 'normal');
                        doc.setTextColor(80, 80, 80);
                        const descLines = doc.splitTextToSize(`ุชูุถุญุงุช: ${transaction.description}`, 160);
                        doc.text(descLines, 25, yPosition + 25);
                    }
                    
                    yPosition += boxHeight + 10;
                });
            }
            
            // Add Persian professional footer
            const pageCount = doc.internal.getNumberOfPages();
            for (let i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                
                // Footer line
                doc.setDrawColor(200, 200, 200);
                doc.setLineWidth(0.5);
                doc.line(20, 280, 190, 280);
                
                doc.setFont('helvetica', 'normal');
                doc.setFontSize(9);
                doc.setTextColor(120, 120, 120);
                
                // Persian date and time
                const now = new Date();
                const persianDate = now.toLocaleDateString('fa-IR');
                const persianTime = now.toLocaleTimeString('fa-IR');
                doc.text(`ุชุงุฑุฎ ุชููุฏ ฺฏุฒุงุฑุด: ${toPersianNumbers(persianDate)} - ุณุงุนุช: ${toPersianNumbers(persianTime)}`, 20, 285);
                
                // Persian page numbers
                doc.text(`ุตูุญู ${toPersianNumbers(i)} ุงุฒ ${toPersianNumbers(pageCount)}`, 170, 285);
                
                // Report title in footer
                doc.text(`ฺฏุฒุงุฑุด ${person.name}`, 105, 285, { align: 'center' });
            }
            
            // Save with Persian filename
            const persianDate = new Date().toLocaleDateString('fa-IR').replace(/\//g, '-');
            doc.save(`ฺฏุฒุงุฑุด-ุชูุตู-${person.name}-${toPersianNumbers(persianDate)}.pdf`);
        }

        // Share Individual Report
        function shareIndividualReport(personId, platform) {
            const person = people.find(p => p.id === personId);
            if (!person) return;
            
            const personTransactions = transactions.filter(t => t.personId === personId);
            const totalCredit = personTransactions.filter(t => t.type === 'credit').reduce((sum, t) => sum + t.amount, 0);
            const totalDebt = personTransactions.filter(t => t.type === 'debt').reduce((sum, t) => sum + t.amount, 0);
            
            // Create detailed report text
            let reportText = `๐ ฺฏุฒุงุฑุด ุญุณุงุจุฏุงุฑ - ${person.name}\n\n`;
            
            if (person.phone) reportText += `๐ฑ ุชููู: ${person.phone}\n`;
            if (person.address) reportText += `๐ ุขุฏุฑุณ: ${person.address}\n`;
            
            reportText += `\n๐ฐ ุฎูุงุตู ูุงู:\n`;
            reportText += `๐ ฺฉู ุทูุจ: ${totalCredit.toLocaleString()} ุชููุงู\n`;
            reportText += `๐ ฺฉู ุจุฏู: ${totalDebt.toLocaleString()} ุชููุงู\n`;
            reportText += `โ๏ธ ููุฌูุฏ ููุง: ${Math.abs(person.balance).toLocaleString()} ุชููุงู (${person.balance >= 0 ? 'ุทูุจฺฉุงุฑ' : 'ุจุฏูฺฉุงุฑ'})\n\n`;
            
            reportText += `๐ ุชุงุฑุฎฺู ุชุฑุงฺฉูุดโูุง (${personTransactions.length} ุชุฑุงฺฉูุด):\n`;
            
            if (personTransactions.length === 0) {
                reportText += `ูฺ ุชุฑุงฺฉูุด ุซุจุช ูุดุฏู ุงุณุช\n`;
            } else {
                personTransactions.forEach((transaction, index) => {
                    const typeIcon = transaction.type === 'credit' ? '๐' : '๐';
                    const typeText = transaction.type === 'credit' ? 'ุทูุจฺฉุงุฑ' : 'ุจุฏูฺฉุงุฑ';
                    
                    reportText += `${index + 1}. ${typeIcon} ${transaction.date} - ${typeText}\n`;
                    reportText += `   ูุจูุบ: ${transaction.amount.toLocaleString()} ุชููุงู\n`;
                    if (transaction.description) {
                        reportText += `   ุชูุถุญุงุช: ${transaction.description}\n`;
                    }
                    reportText += `\n`;
                });
            }
            
            reportText += `๐ ุชุงุฑุฎ ฺฏุฒุงุฑุด: ${new Date().toLocaleDateString('fa-IR')}`;
            
            const encodedText = encodeURIComponent(reportText);
            
            let shareUrl = '';
            
            switch(platform) {
                case 'telegram':
                    shareUrl = `https://t.me/share/url?url=${encodedText}`;
                    break;
                case 'whatsapp':
                    shareUrl = `https://wa.me/?text=${encodedText}`;
                    break;
                case 'eitaa':
                    shareUrl = `https://eitaa.com/share/url?url=${encodedText}`;
                    break;
                case 'sms':
                    shareUrl = `sms:?body=${encodedText}`;
                    break;
                default:
                    // Generic share
                    if (navigator.share) {
                        navigator.share({
                            title: `ฺฏุฒุงุฑุด ุญุณุงุจุฏุงุฑ - ${person.name}`,
                            text: reportText
                        });
                        return;
                    }
            }
            
            if (shareUrl) {
                window.open(shareUrl, '_blank');
            }
        }

        // Initialize system when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM Content Loaded');
            setupEventListeners();
            initializeSystem();
            loadTheme();
            
            // Check subscription status every hour
            setInterval(() => {
                if (currentUser) {
                    updateTrialStatus();
                    checkSubscriptionStatus();
                }
            }, 3600000); // 1 hour
        });
        
        // Also initialize immediately in case DOMContentLoaded already fired
        if (document.readyState === 'loading') {
            console.log('Document still loading...');
        } else {
            console.log('Document already loaded, initializing...');
            setupEventListeners();
            initializeSystem();
            loadTheme();
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96e6fc95f231c725',t:'MTc1NTA3NTI1NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
